/*
 * Copyright (c) 2016 PrivatBank IT <acsk@privatbank.ua>. All rights reserved.
 * Redistribution and modifications are permitted subject to BSD license.
 */

#include <memory.h>

#include "des.h"
#include "byte_utils_internal.h"
#include "byte_array_internal.h"
#include "macros_internal.h"

#define DES_BLOCK_LEN 8

#undef FILE_MARKER
#define FILE_MARKER "cryptonite/des.c"

typedef enum {
    ECB,
    CTR,
    CFB,
    OFB,
    CBC,
} CipherMode;

struct DesCtx_st {
    uint8_t iv[24];
    uint8_t key[24];
    uint8_t gamma_des3[24];
    uint8_t gamma_des[24];
    size_t offset;
    uint8_t feed[24];
    uint32_t enc_key[96];
    uint32_t dec_key[96];
    CipherMode mode;
};

#define EN0 0
#define DE1 1
#define CONST64(n) n ## ULL
#define byte(x, n) (((x) >> (8 * (n))) & 255)

static const uint32_t bytebit[8] = {
    0200, 0100, 040, 020, 010, 04, 02, 01
};

static const uint32_t bigbyte[24] = {
    0x800000UL, 0x400000UL, 0x200000UL, 0x100000UL,
    0x80000UL, 0x40000UL, 0x20000UL, 0x10000UL,
    0x8000UL, 0x4000UL, 0x2000UL, 0x1000UL,
    0x800UL, 0x400UL, 0x200UL, 0x100UL,
    0x80UL, 0x40UL, 0x20UL, 0x10UL,
    0x8UL, 0x4UL, 0x2UL, 0x1L
};

/* Use the key schedule specific in the standard (ANSI X3.92-1981) */

static const unsigned char pc1[56] = {
    56, 48, 40, 32, 24, 16, 8, 0, 57, 49, 41, 33, 25, 17,
    9, 1, 58, 50, 42, 34, 26, 18, 10, 2, 59, 51, 43, 35,
    62, 54, 46, 38, 30, 22, 14, 6, 61, 53, 45, 37, 29, 21,
    13, 5, 60, 52, 44, 36, 28, 20, 12, 4, 27, 19, 11, 3
};

static const unsigned char totrot[16] = {
    1, 2, 4, 6,
    8, 10, 12, 14,
    15, 17, 19, 21,
    23, 25, 27, 28
};

static const unsigned char pc2[48] = {
    13, 16, 10, 23, 0, 4, 2, 27, 14, 5, 20, 9,
    22, 18, 11, 3, 25, 7, 15, 6, 26, 19, 12, 1,
    40, 51, 30, 36, 46, 54, 29, 39, 50, 44, 32, 47,
    43, 48, 38, 55, 33, 52, 45, 41, 49, 35, 28, 31
};


static const uint32_t SP1[64] = {
    0x01010400UL, 0x00000000UL, 0x00010000UL, 0x01010404UL,
    0x01010004UL, 0x00010404UL, 0x00000004UL, 0x00010000UL,
    0x00000400UL, 0x01010400UL, 0x01010404UL, 0x00000400UL,
    0x01000404UL, 0x01010004UL, 0x01000000UL, 0x00000004UL,
    0x00000404UL, 0x01000400UL, 0x01000400UL, 0x00010400UL,
    0x00010400UL, 0x01010000UL, 0x01010000UL, 0x01000404UL,
    0x00010004UL, 0x01000004UL, 0x01000004UL, 0x00010004UL,
    0x00000000UL, 0x00000404UL, 0x00010404UL, 0x01000000UL,
    0x00010000UL, 0x01010404UL, 0x00000004UL, 0x01010000UL,
    0x01010400UL, 0x01000000UL, 0x01000000UL, 0x00000400UL,
    0x01010004UL, 0x00010000UL, 0x00010400UL, 0x01000004UL,
    0x00000400UL, 0x00000004UL, 0x01000404UL, 0x00010404UL,
    0x01010404UL, 0x00010004UL, 0x01010000UL, 0x01000404UL,
    0x01000004UL, 0x00000404UL, 0x00010404UL, 0x01010400UL,
    0x00000404UL, 0x01000400UL, 0x01000400UL, 0x00000000UL,
    0x00010004UL, 0x00010400UL, 0x00000000UL, 0x01010004UL
};

static const uint32_t SP2[64] = {
    0x80108020UL, 0x80008000UL, 0x00008000UL, 0x00108020UL,
    0x00100000UL, 0x00000020UL, 0x80100020UL, 0x80008020UL,
    0x80000020UL, 0x80108020UL, 0x80108000UL, 0x80000000UL,
    0x80008000UL, 0x00100000UL, 0x00000020UL, 0x80100020UL,
    0x00108000UL, 0x00100020UL, 0x80008020UL, 0x00000000UL,
    0x80000000UL, 0x00008000UL, 0x00108020UL, 0x80100000UL,
    0x00100020UL, 0x80000020UL, 0x00000000UL, 0x00108000UL,
    0x00008020UL, 0x80108000UL, 0x80100000UL, 0x00008020UL,
    0x00000000UL, 0x00108020UL, 0x80100020UL, 0x00100000UL,
    0x80008020UL, 0x80100000UL, 0x80108000UL, 0x00008000UL,
    0x80100000UL, 0x80008000UL, 0x00000020UL, 0x80108020UL,
    0x00108020UL, 0x00000020UL, 0x00008000UL, 0x80000000UL,
    0x00008020UL, 0x80108000UL, 0x00100000UL, 0x80000020UL,
    0x00100020UL, 0x80008020UL, 0x80000020UL, 0x00100020UL,
    0x00108000UL, 0x00000000UL, 0x80008000UL, 0x00008020UL,
    0x80000000UL, 0x80100020UL, 0x80108020UL, 0x00108000UL
};

static const uint32_t SP3[64] = {
    0x00000208UL, 0x08020200UL, 0x00000000UL, 0x08020008UL,
    0x08000200UL, 0x00000000UL, 0x00020208UL, 0x08000200UL,
    0x00020008UL, 0x08000008UL, 0x08000008UL, 0x00020000UL,
    0x08020208UL, 0x00020008UL, 0x08020000UL, 0x00000208UL,
    0x08000000UL, 0x00000008UL, 0x08020200UL, 0x00000200UL,
    0x00020200UL, 0x08020000UL, 0x08020008UL, 0x00020208UL,
    0x08000208UL, 0x00020200UL, 0x00020000UL, 0x08000208UL,
    0x00000008UL, 0x08020208UL, 0x00000200UL, 0x08000000UL,
    0x08020200UL, 0x08000000UL, 0x00020008UL, 0x00000208UL,
    0x00020000UL, 0x08020200UL, 0x08000200UL, 0x00000000UL,
    0x00000200UL, 0x00020008UL, 0x08020208UL, 0x08000200UL,
    0x08000008UL, 0x00000200UL, 0x00000000UL, 0x08020008UL,
    0x08000208UL, 0x00020000UL, 0x08000000UL, 0x08020208UL,
    0x00000008UL, 0x00020208UL, 0x00020200UL, 0x08000008UL,
    0x08020000UL, 0x08000208UL, 0x00000208UL, 0x08020000UL,
    0x00020208UL, 0x00000008UL, 0x08020008UL, 0x00020200UL
};

static const uint32_t SP4[64] = {
    0x00802001UL, 0x00002081UL, 0x00002081UL, 0x00000080UL,
    0x00802080UL, 0x00800081UL, 0x00800001UL, 0x00002001UL,
    0x00000000UL, 0x00802000UL, 0x00802000UL, 0x00802081UL,
    0x00000081UL, 0x00000000UL, 0x00800080UL, 0x00800001UL,
    0x00000001UL, 0x00002000UL, 0x00800000UL, 0x00802001UL,
    0x00000080UL, 0x00800000UL, 0x00002001UL, 0x00002080UL,
    0x00800081UL, 0x00000001UL, 0x00002080UL, 0x00800080UL,
    0x00002000UL, 0x00802080UL, 0x00802081UL, 0x00000081UL,
    0x00800080UL, 0x00800001UL, 0x00802000UL, 0x00802081UL,
    0x00000081UL, 0x00000000UL, 0x00000000UL, 0x00802000UL,
    0x00002080UL, 0x00800080UL, 0x00800081UL, 0x00000001UL,
    0x00802001UL, 0x00002081UL, 0x00002081UL, 0x00000080UL,
    0x00802081UL, 0x00000081UL, 0x00000001UL, 0x00002000UL,
    0x00800001UL, 0x00002001UL, 0x00802080UL, 0x00800081UL,
    0x00002001UL, 0x00002080UL, 0x00800000UL, 0x00802001UL,
    0x00000080UL, 0x00800000UL, 0x00002000UL, 0x00802080UL
};

static const uint32_t SP5[64] = {
    0x00000100UL, 0x02080100UL, 0x02080000UL, 0x42000100UL,
    0x00080000UL, 0x00000100UL, 0x40000000UL, 0x02080000UL,
    0x40080100UL, 0x00080000UL, 0x02000100UL, 0x40080100UL,
    0x42000100UL, 0x42080000UL, 0x00080100UL, 0x40000000UL,
    0x02000000UL, 0x40080000UL, 0x40080000UL, 0x00000000UL,
    0x40000100UL, 0x42080100UL, 0x42080100UL, 0x02000100UL,
    0x42080000UL, 0x40000100UL, 0x00000000UL, 0x42000000UL,
    0x02080100UL, 0x02000000UL, 0x42000000UL, 0x00080100UL,
    0x00080000UL, 0x42000100UL, 0x00000100UL, 0x02000000UL,
    0x40000000UL, 0x02080000UL, 0x42000100UL, 0x40080100UL,
    0x02000100UL, 0x40000000UL, 0x42080000UL, 0x02080100UL,
    0x40080100UL, 0x00000100UL, 0x02000000UL, 0x42080000UL,
    0x42080100UL, 0x00080100UL, 0x42000000UL, 0x42080100UL,
    0x02080000UL, 0x00000000UL, 0x40080000UL, 0x42000000UL,
    0x00080100UL, 0x02000100UL, 0x40000100UL, 0x00080000UL,
    0x00000000UL, 0x40080000UL, 0x02080100UL, 0x40000100UL
};

static const uint32_t SP6[64] = {
    0x20000010UL, 0x20400000UL, 0x00004000UL, 0x20404010UL,
    0x20400000UL, 0x00000010UL, 0x20404010UL, 0x00400000UL,
    0x20004000UL, 0x00404010UL, 0x00400000UL, 0x20000010UL,
    0x00400010UL, 0x20004000UL, 0x20000000UL, 0x00004010UL,
    0x00000000UL, 0x00400010UL, 0x20004010UL, 0x00004000UL,
    0x00404000UL, 0x20004010UL, 0x00000010UL, 0x20400010UL,
    0x20400010UL, 0x00000000UL, 0x00404010UL, 0x20404000UL,
    0x00004010UL, 0x00404000UL, 0x20404000UL, 0x20000000UL,
    0x20004000UL, 0x00000010UL, 0x20400010UL, 0x00404000UL,
    0x20404010UL, 0x00400000UL, 0x00004010UL, 0x20000010UL,
    0x00400000UL, 0x20004000UL, 0x20000000UL, 0x00004010UL,
    0x20000010UL, 0x20404010UL, 0x00404000UL, 0x20400000UL,
    0x00404010UL, 0x20404000UL, 0x00000000UL, 0x20400010UL,
    0x00000010UL, 0x00004000UL, 0x20400000UL, 0x00404010UL,
    0x00004000UL, 0x00400010UL, 0x20004010UL, 0x00000000UL,
    0x20404000UL, 0x20000000UL, 0x00400010UL, 0x20004010UL
};

static const uint32_t SP7[64] = {
    0x00200000UL, 0x04200002UL, 0x04000802UL, 0x00000000UL,
    0x00000800UL, 0x04000802UL, 0x00200802UL, 0x04200800UL,
    0x04200802UL, 0x00200000UL, 0x00000000UL, 0x04000002UL,
    0x00000002UL, 0x04000000UL, 0x04200002UL, 0x00000802UL,
    0x04000800UL, 0x00200802UL, 0x00200002UL, 0x04000800UL,
    0x04000002UL, 0x04200000UL, 0x04200800UL, 0x00200002UL,
    0x04200000UL, 0x00000800UL, 0x00000802UL, 0x04200802UL,
    0x00200800UL, 0x00000002UL, 0x04000000UL, 0x00200800UL,
    0x04000000UL, 0x00200800UL, 0x00200000UL, 0x04000802UL,
    0x04000802UL, 0x04200002UL, 0x04200002UL, 0x00000002UL,
    0x00200002UL, 0x04000000UL, 0x04000800UL, 0x00200000UL,
    0x04200800UL, 0x00000802UL, 0x00200802UL, 0x04200800UL,
    0x00000802UL, 0x04000002UL, 0x04200802UL, 0x04200000UL,
    0x00200800UL, 0x00000000UL, 0x00000002UL, 0x04200802UL,
    0x00000000UL, 0x00200802UL, 0x04200000UL, 0x00000800UL,
    0x04000002UL, 0x04000800UL, 0x00000800UL, 0x00200002UL
};

static const uint32_t SP8[64] = {
    0x10001040UL, 0x00001000UL, 0x00040000UL, 0x10041040UL,
    0x10000000UL, 0x10001040UL, 0x00000040UL, 0x10000000UL,
    0x00040040UL, 0x10040000UL, 0x10041040UL, 0x00041000UL,
    0x10041000UL, 0x00041040UL, 0x00001000UL, 0x00000040UL,
    0x10040000UL, 0x10000040UL, 0x10001000UL, 0x00001040UL,
    0x00041000UL, 0x00040040UL, 0x10040040UL, 0x10041000UL,
    0x00001040UL, 0x00000000UL, 0x00000000UL, 0x10040040UL,
    0x10000040UL, 0x10001000UL, 0x00041040UL, 0x00040000UL,
    0x00041040UL, 0x00040000UL, 0x10041000UL, 0x00001000UL,
    0x00000040UL, 0x10040040UL, 0x00001000UL, 0x00041040UL,
    0x10001000UL, 0x00000040UL, 0x10000040UL, 0x10040000UL,
    0x10040040UL, 0x10000000UL, 0x00040000UL, 0x10001040UL,
    0x00000000UL, 0x10041040UL, 0x00040040UL, 0x10000040UL,
    0x10040000UL, 0x10001000UL, 0x10001040UL, 0x00000000UL,
    0x10041040UL, 0x00041000UL, 0x00041000UL, 0x00001040UL,
    0x00001040UL, 0x00040040UL, 0x10000000UL, 0x10041000UL
};

static const uint64_t des_ip[8][256] = {

    {
        0x0000000000000000ULL, 0x0000001000000000ULL, 0x0000000000000010ULL, 0x0000001000000010ULL,
        0x0000100000000000ULL, 0x0000101000000000ULL, 0x0000100000000010ULL, 0x0000101000000010ULL,
        0x0000000000001000ULL, 0x0000001000001000ULL, 0x0000000000001010ULL, 0x0000001000001010ULL,
        0x0000100000001000ULL, 0x0000101000001000ULL, 0x0000100000001010ULL, 0x0000101000001010ULL,
        0x0010000000000000ULL, 0x0010001000000000ULL, 0x0010000000000010ULL, 0x0010001000000010ULL,
        0x0010100000000000ULL, 0x0010101000000000ULL, 0x0010100000000010ULL, 0x0010101000000010ULL,
        0x0010000000001000ULL, 0x0010001000001000ULL, 0x0010000000001010ULL, 0x0010001000001010ULL,
        0x0010100000001000ULL, 0x0010101000001000ULL, 0x0010100000001010ULL, 0x0010101000001010ULL,
        0x0000000000100000ULL, 0x0000001000100000ULL, 0x0000000000100010ULL, 0x0000001000100010ULL,
        0x0000100000100000ULL, 0x0000101000100000ULL, 0x0000100000100010ULL, 0x0000101000100010ULL,
        0x0000000000101000ULL, 0x0000001000101000ULL, 0x0000000000101010ULL, 0x0000001000101010ULL,
        0x0000100000101000ULL, 0x0000101000101000ULL, 0x0000100000101010ULL, 0x0000101000101010ULL,
        0x0010000000100000ULL, 0x0010001000100000ULL, 0x0010000000100010ULL, 0x0010001000100010ULL,
        0x0010100000100000ULL, 0x0010101000100000ULL, 0x0010100000100010ULL, 0x0010101000100010ULL,
        0x0010000000101000ULL, 0x0010001000101000ULL, 0x0010000000101010ULL, 0x0010001000101010ULL,
        0x0010100000101000ULL, 0x0010101000101000ULL, 0x0010100000101010ULL, 0x0010101000101010ULL,
        0x1000000000000000ULL, 0x1000001000000000ULL, 0x1000000000000010ULL, 0x1000001000000010ULL,
        0x1000100000000000ULL, 0x1000101000000000ULL, 0x1000100000000010ULL, 0x1000101000000010ULL,
        0x1000000000001000ULL, 0x1000001000001000ULL, 0x1000000000001010ULL, 0x1000001000001010ULL,
        0x1000100000001000ULL, 0x1000101000001000ULL, 0x1000100000001010ULL, 0x1000101000001010ULL,
        0x1010000000000000ULL, 0x1010001000000000ULL, 0x1010000000000010ULL, 0x1010001000000010ULL,
        0x1010100000000000ULL, 0x1010101000000000ULL, 0x1010100000000010ULL, 0x1010101000000010ULL,
        0x1010000000001000ULL, 0x1010001000001000ULL, 0x1010000000001010ULL, 0x1010001000001010ULL,
        0x1010100000001000ULL, 0x1010101000001000ULL, 0x1010100000001010ULL, 0x1010101000001010ULL,
        0x1000000000100000ULL, 0x1000001000100000ULL, 0x1000000000100010ULL, 0x1000001000100010ULL,
        0x1000100000100000ULL, 0x1000101000100000ULL, 0x1000100000100010ULL, 0x1000101000100010ULL,
        0x1000000000101000ULL, 0x1000001000101000ULL, 0x1000000000101010ULL, 0x1000001000101010ULL,
        0x1000100000101000ULL, 0x1000101000101000ULL, 0x1000100000101010ULL, 0x1000101000101010ULL,
        0x1010000000100000ULL, 0x1010001000100000ULL, 0x1010000000100010ULL, 0x1010001000100010ULL,
        0x1010100000100000ULL, 0x1010101000100000ULL, 0x1010100000100010ULL, 0x1010101000100010ULL,
        0x1010000000101000ULL, 0x1010001000101000ULL, 0x1010000000101010ULL, 0x1010001000101010ULL,
        0x1010100000101000ULL, 0x1010101000101000ULL, 0x1010100000101010ULL, 0x1010101000101010ULL,
        0x0000000010000000ULL, 0x0000001010000000ULL, 0x0000000010000010ULL, 0x0000001010000010ULL,
        0x0000100010000000ULL, 0x0000101010000000ULL, 0x0000100010000010ULL, 0x0000101010000010ULL,
        0x0000000010001000ULL, 0x0000001010001000ULL, 0x0000000010001010ULL, 0x0000001010001010ULL,
        0x0000100010001000ULL, 0x0000101010001000ULL, 0x0000100010001010ULL, 0x0000101010001010ULL,
        0x0010000010000000ULL, 0x0010001010000000ULL, 0x0010000010000010ULL, 0x0010001010000010ULL,
        0x0010100010000000ULL, 0x0010101010000000ULL, 0x0010100010000010ULL, 0x0010101010000010ULL,
        0x0010000010001000ULL, 0x0010001010001000ULL, 0x0010000010001010ULL, 0x0010001010001010ULL,
        0x0010100010001000ULL, 0x0010101010001000ULL, 0x0010100010001010ULL, 0x0010101010001010ULL,
        0x0000000010100000ULL, 0x0000001010100000ULL, 0x0000000010100010ULL, 0x0000001010100010ULL,
        0x0000100010100000ULL, 0x0000101010100000ULL, 0x0000100010100010ULL, 0x0000101010100010ULL,
        0x0000000010101000ULL, 0x0000001010101000ULL, 0x0000000010101010ULL, 0x0000001010101010ULL,
        0x0000100010101000ULL, 0x0000101010101000ULL, 0x0000100010101010ULL, 0x0000101010101010ULL,
        0x0010000010100000ULL, 0x0010001010100000ULL, 0x0010000010100010ULL, 0x0010001010100010ULL,
        0x0010100010100000ULL, 0x0010101010100000ULL, 0x0010100010100010ULL, 0x0010101010100010ULL,
        0x0010000010101000ULL, 0x0010001010101000ULL, 0x0010000010101010ULL, 0x0010001010101010ULL,
        0x0010100010101000ULL, 0x0010101010101000ULL, 0x0010100010101010ULL, 0x0010101010101010ULL,
        0x1000000010000000ULL, 0x1000001010000000ULL, 0x1000000010000010ULL, 0x1000001010000010ULL,
        0x1000100010000000ULL, 0x1000101010000000ULL, 0x1000100010000010ULL, 0x1000101010000010ULL,
        0x1000000010001000ULL, 0x1000001010001000ULL, 0x1000000010001010ULL, 0x1000001010001010ULL,
        0x1000100010001000ULL, 0x1000101010001000ULL, 0x1000100010001010ULL, 0x1000101010001010ULL,
        0x1010000010000000ULL, 0x1010001010000000ULL, 0x1010000010000010ULL, 0x1010001010000010ULL,
        0x1010100010000000ULL, 0x1010101010000000ULL, 0x1010100010000010ULL, 0x1010101010000010ULL,
        0x1010000010001000ULL, 0x1010001010001000ULL, 0x1010000010001010ULL, 0x1010001010001010ULL,
        0x1010100010001000ULL, 0x1010101010001000ULL, 0x1010100010001010ULL, 0x1010101010001010ULL,
        0x1000000010100000ULL, 0x1000001010100000ULL, 0x1000000010100010ULL, 0x1000001010100010ULL,
        0x1000100010100000ULL, 0x1000101010100000ULL, 0x1000100010100010ULL, 0x1000101010100010ULL,
        0x1000000010101000ULL, 0x1000001010101000ULL, 0x1000000010101010ULL, 0x1000001010101010ULL,
        0x1000100010101000ULL, 0x1000101010101000ULL, 0x1000100010101010ULL, 0x1000101010101010ULL,
        0x1010000010100000ULL, 0x1010001010100000ULL, 0x1010000010100010ULL, 0x1010001010100010ULL,
        0x1010100010100000ULL, 0x1010101010100000ULL, 0x1010100010100010ULL, 0x1010101010100010ULL,
        0x1010000010101000ULL, 0x1010001010101000ULL, 0x1010000010101010ULL, 0x1010001010101010ULL,
        0x1010100010101000ULL, 0x1010101010101000ULL, 0x1010100010101010ULL, 0x1010101010101010ULL
    },
    {
        0x0000000000000000ULL, 0x0000000800000000ULL, 0x0000000000000008ULL, 0x0000000800000008ULL,
        0x0000080000000000ULL, 0x0000080800000000ULL, 0x0000080000000008ULL, 0x0000080800000008ULL,
        0x0000000000000800ULL, 0x0000000800000800ULL, 0x0000000000000808ULL, 0x0000000800000808ULL,
        0x0000080000000800ULL, 0x0000080800000800ULL, 0x0000080000000808ULL, 0x0000080800000808ULL,
        0x0008000000000000ULL, 0x0008000800000000ULL, 0x0008000000000008ULL, 0x0008000800000008ULL,
        0x0008080000000000ULL, 0x0008080800000000ULL, 0x0008080000000008ULL, 0x0008080800000008ULL,
        0x0008000000000800ULL, 0x0008000800000800ULL, 0x0008000000000808ULL, 0x0008000800000808ULL,
        0x0008080000000800ULL, 0x0008080800000800ULL, 0x0008080000000808ULL, 0x0008080800000808ULL,
        0x0000000000080000ULL, 0x0000000800080000ULL, 0x0000000000080008ULL, 0x0000000800080008ULL,
        0x0000080000080000ULL, 0x0000080800080000ULL, 0x0000080000080008ULL, 0x0000080800080008ULL,
        0x0000000000080800ULL, 0x0000000800080800ULL, 0x0000000000080808ULL, 0x0000000800080808ULL,
        0x0000080000080800ULL, 0x0000080800080800ULL, 0x0000080000080808ULL, 0x0000080800080808ULL,
        0x0008000000080000ULL, 0x0008000800080000ULL, 0x0008000000080008ULL, 0x0008000800080008ULL,
        0x0008080000080000ULL, 0x0008080800080000ULL, 0x0008080000080008ULL, 0x0008080800080008ULL,
        0x0008000000080800ULL, 0x0008000800080800ULL, 0x0008000000080808ULL, 0x0008000800080808ULL,
        0x0008080000080800ULL, 0x0008080800080800ULL, 0x0008080000080808ULL, 0x0008080800080808ULL,
        0x0800000000000000ULL, 0x0800000800000000ULL, 0x0800000000000008ULL, 0x0800000800000008ULL,
        0x0800080000000000ULL, 0x0800080800000000ULL, 0x0800080000000008ULL, 0x0800080800000008ULL,
        0x0800000000000800ULL, 0x0800000800000800ULL, 0x0800000000000808ULL, 0x0800000800000808ULL,
        0x0800080000000800ULL, 0x0800080800000800ULL, 0x0800080000000808ULL, 0x0800080800000808ULL,
        0x0808000000000000ULL, 0x0808000800000000ULL, 0x0808000000000008ULL, 0x0808000800000008ULL,
        0x0808080000000000ULL, 0x0808080800000000ULL, 0x0808080000000008ULL, 0x0808080800000008ULL,
        0x0808000000000800ULL, 0x0808000800000800ULL, 0x0808000000000808ULL, 0x0808000800000808ULL,
        0x0808080000000800ULL, 0x0808080800000800ULL, 0x0808080000000808ULL, 0x0808080800000808ULL,
        0x0800000000080000ULL, 0x0800000800080000ULL, 0x0800000000080008ULL, 0x0800000800080008ULL,
        0x0800080000080000ULL, 0x0800080800080000ULL, 0x0800080000080008ULL, 0x0800080800080008ULL,
        0x0800000000080800ULL, 0x0800000800080800ULL, 0x0800000000080808ULL, 0x0800000800080808ULL,
        0x0800080000080800ULL, 0x0800080800080800ULL, 0x0800080000080808ULL, 0x0800080800080808ULL,
        0x0808000000080000ULL, 0x0808000800080000ULL, 0x0808000000080008ULL, 0x0808000800080008ULL,
        0x0808080000080000ULL, 0x0808080800080000ULL, 0x0808080000080008ULL, 0x0808080800080008ULL,
        0x0808000000080800ULL, 0x0808000800080800ULL, 0x0808000000080808ULL, 0x0808000800080808ULL,
        0x0808080000080800ULL, 0x0808080800080800ULL, 0x0808080000080808ULL, 0x0808080800080808ULL,
        0x0000000008000000ULL, 0x0000000808000000ULL, 0x0000000008000008ULL, 0x0000000808000008ULL,
        0x0000080008000000ULL, 0x0000080808000000ULL, 0x0000080008000008ULL, 0x0000080808000008ULL,
        0x0000000008000800ULL, 0x0000000808000800ULL, 0x0000000008000808ULL, 0x0000000808000808ULL,
        0x0000080008000800ULL, 0x0000080808000800ULL, 0x0000080008000808ULL, 0x0000080808000808ULL,
        0x0008000008000000ULL, 0x0008000808000000ULL, 0x0008000008000008ULL, 0x0008000808000008ULL,
        0x0008080008000000ULL, 0x0008080808000000ULL, 0x0008080008000008ULL, 0x0008080808000008ULL,
        0x0008000008000800ULL, 0x0008000808000800ULL, 0x0008000008000808ULL, 0x0008000808000808ULL,
        0x0008080008000800ULL, 0x0008080808000800ULL, 0x0008080008000808ULL, 0x0008080808000808ULL,
        0x0000000008080000ULL, 0x0000000808080000ULL, 0x0000000008080008ULL, 0x0000000808080008ULL,
        0x0000080008080000ULL, 0x0000080808080000ULL, 0x0000080008080008ULL, 0x0000080808080008ULL,
        0x0000000008080800ULL, 0x0000000808080800ULL, 0x0000000008080808ULL, 0x0000000808080808ULL,
        0x0000080008080800ULL, 0x0000080808080800ULL, 0x0000080008080808ULL, 0x0000080808080808ULL,
        0x0008000008080000ULL, 0x0008000808080000ULL, 0x0008000008080008ULL, 0x0008000808080008ULL,
        0x0008080008080000ULL, 0x0008080808080000ULL, 0x0008080008080008ULL, 0x0008080808080008ULL,
        0x0008000008080800ULL, 0x0008000808080800ULL, 0x0008000008080808ULL, 0x0008000808080808ULL,
        0x0008080008080800ULL, 0x0008080808080800ULL, 0x0008080008080808ULL, 0x0008080808080808ULL,
        0x0800000008000000ULL, 0x0800000808000000ULL, 0x0800000008000008ULL, 0x0800000808000008ULL,
        0x0800080008000000ULL, 0x0800080808000000ULL, 0x0800080008000008ULL, 0x0800080808000008ULL,
        0x0800000008000800ULL, 0x0800000808000800ULL, 0x0800000008000808ULL, 0x0800000808000808ULL,
        0x0800080008000800ULL, 0x0800080808000800ULL, 0x0800080008000808ULL, 0x0800080808000808ULL,
        0x0808000008000000ULL, 0x0808000808000000ULL, 0x0808000008000008ULL, 0x0808000808000008ULL,
        0x0808080008000000ULL, 0x0808080808000000ULL, 0x0808080008000008ULL, 0x0808080808000008ULL,
        0x0808000008000800ULL, 0x0808000808000800ULL, 0x0808000008000808ULL, 0x0808000808000808ULL,
        0x0808080008000800ULL, 0x0808080808000800ULL, 0x0808080008000808ULL, 0x0808080808000808ULL,
        0x0800000008080000ULL, 0x0800000808080000ULL, 0x0800000008080008ULL, 0x0800000808080008ULL,
        0x0800080008080000ULL, 0x0800080808080000ULL, 0x0800080008080008ULL, 0x0800080808080008ULL,
        0x0800000008080800ULL, 0x0800000808080800ULL, 0x0800000008080808ULL, 0x0800000808080808ULL,
        0x0800080008080800ULL, 0x0800080808080800ULL, 0x0800080008080808ULL, 0x0800080808080808ULL,
        0x0808000008080000ULL, 0x0808000808080000ULL, 0x0808000008080008ULL, 0x0808000808080008ULL,
        0x0808080008080000ULL, 0x0808080808080000ULL, 0x0808080008080008ULL, 0x0808080808080008ULL,
        0x0808000008080800ULL, 0x0808000808080800ULL, 0x0808000008080808ULL, 0x0808000808080808ULL,
        0x0808080008080800ULL, 0x0808080808080800ULL, 0x0808080008080808ULL, 0x0808080808080808ULL
    },
    {
        0x0000000000000000ULL, 0x0000000400000000ULL, 0x0000000000000004ULL, 0x0000000400000004ULL,
        0x0000040000000000ULL, 0x0000040400000000ULL, 0x0000040000000004ULL, 0x0000040400000004ULL,
        0x0000000000000400ULL, 0x0000000400000400ULL, 0x0000000000000404ULL, 0x0000000400000404ULL,
        0x0000040000000400ULL, 0x0000040400000400ULL, 0x0000040000000404ULL, 0x0000040400000404ULL,
        0x0004000000000000ULL, 0x0004000400000000ULL, 0x0004000000000004ULL, 0x0004000400000004ULL,
        0x0004040000000000ULL, 0x0004040400000000ULL, 0x0004040000000004ULL, 0x0004040400000004ULL,
        0x0004000000000400ULL, 0x0004000400000400ULL, 0x0004000000000404ULL, 0x0004000400000404ULL,
        0x0004040000000400ULL, 0x0004040400000400ULL, 0x0004040000000404ULL, 0x0004040400000404ULL,
        0x0000000000040000ULL, 0x0000000400040000ULL, 0x0000000000040004ULL, 0x0000000400040004ULL,
        0x0000040000040000ULL, 0x0000040400040000ULL, 0x0000040000040004ULL, 0x0000040400040004ULL,
        0x0000000000040400ULL, 0x0000000400040400ULL, 0x0000000000040404ULL, 0x0000000400040404ULL,
        0x0000040000040400ULL, 0x0000040400040400ULL, 0x0000040000040404ULL, 0x0000040400040404ULL,
        0x0004000000040000ULL, 0x0004000400040000ULL, 0x0004000000040004ULL, 0x0004000400040004ULL,
        0x0004040000040000ULL, 0x0004040400040000ULL, 0x0004040000040004ULL, 0x0004040400040004ULL,
        0x0004000000040400ULL, 0x0004000400040400ULL, 0x0004000000040404ULL, 0x0004000400040404ULL,
        0x0004040000040400ULL, 0x0004040400040400ULL, 0x0004040000040404ULL, 0x0004040400040404ULL,
        0x0400000000000000ULL, 0x0400000400000000ULL, 0x0400000000000004ULL, 0x0400000400000004ULL,
        0x0400040000000000ULL, 0x0400040400000000ULL, 0x0400040000000004ULL, 0x0400040400000004ULL,
        0x0400000000000400ULL, 0x0400000400000400ULL, 0x0400000000000404ULL, 0x0400000400000404ULL,
        0x0400040000000400ULL, 0x0400040400000400ULL, 0x0400040000000404ULL, 0x0400040400000404ULL,
        0x0404000000000000ULL, 0x0404000400000000ULL, 0x0404000000000004ULL, 0x0404000400000004ULL,
        0x0404040000000000ULL, 0x0404040400000000ULL, 0x0404040000000004ULL, 0x0404040400000004ULL,
        0x0404000000000400ULL, 0x0404000400000400ULL, 0x0404000000000404ULL, 0x0404000400000404ULL,
        0x0404040000000400ULL, 0x0404040400000400ULL, 0x0404040000000404ULL, 0x0404040400000404ULL,
        0x0400000000040000ULL, 0x0400000400040000ULL, 0x0400000000040004ULL, 0x0400000400040004ULL,
        0x0400040000040000ULL, 0x0400040400040000ULL, 0x0400040000040004ULL, 0x0400040400040004ULL,
        0x0400000000040400ULL, 0x0400000400040400ULL, 0x0400000000040404ULL, 0x0400000400040404ULL,
        0x0400040000040400ULL, 0x0400040400040400ULL, 0x0400040000040404ULL, 0x0400040400040404ULL,
        0x0404000000040000ULL, 0x0404000400040000ULL, 0x0404000000040004ULL, 0x0404000400040004ULL,
        0x0404040000040000ULL, 0x0404040400040000ULL, 0x0404040000040004ULL, 0x0404040400040004ULL,
        0x0404000000040400ULL, 0x0404000400040400ULL, 0x0404000000040404ULL, 0x0404000400040404ULL,
        0x0404040000040400ULL, 0x0404040400040400ULL, 0x0404040000040404ULL, 0x0404040400040404ULL,
        0x0000000004000000ULL, 0x0000000404000000ULL, 0x0000000004000004ULL, 0x0000000404000004ULL,
        0x0000040004000000ULL, 0x0000040404000000ULL, 0x0000040004000004ULL, 0x0000040404000004ULL,
        0x0000000004000400ULL, 0x0000000404000400ULL, 0x0000000004000404ULL, 0x0000000404000404ULL,
        0x0000040004000400ULL, 0x0000040404000400ULL, 0x0000040004000404ULL, 0x0000040404000404ULL,
        0x0004000004000000ULL, 0x0004000404000000ULL, 0x0004000004000004ULL, 0x0004000404000004ULL,
        0x0004040004000000ULL, 0x0004040404000000ULL, 0x0004040004000004ULL, 0x0004040404000004ULL,
        0x0004000004000400ULL, 0x0004000404000400ULL, 0x0004000004000404ULL, 0x0004000404000404ULL,
        0x0004040004000400ULL, 0x0004040404000400ULL, 0x0004040004000404ULL, 0x0004040404000404ULL,
        0x0000000004040000ULL, 0x0000000404040000ULL, 0x0000000004040004ULL, 0x0000000404040004ULL,
        0x0000040004040000ULL, 0x0000040404040000ULL, 0x0000040004040004ULL, 0x0000040404040004ULL,
        0x0000000004040400ULL, 0x0000000404040400ULL, 0x0000000004040404ULL, 0x0000000404040404ULL,
        0x0000040004040400ULL, 0x0000040404040400ULL, 0x0000040004040404ULL, 0x0000040404040404ULL,
        0x0004000004040000ULL, 0x0004000404040000ULL, 0x0004000004040004ULL, 0x0004000404040004ULL,
        0x0004040004040000ULL, 0x0004040404040000ULL, 0x0004040004040004ULL, 0x0004040404040004ULL,
        0x0004000004040400ULL, 0x0004000404040400ULL, 0x0004000004040404ULL, 0x0004000404040404ULL,
        0x0004040004040400ULL, 0x0004040404040400ULL, 0x0004040004040404ULL, 0x0004040404040404ULL,
        0x0400000004000000ULL, 0x0400000404000000ULL, 0x0400000004000004ULL, 0x0400000404000004ULL,
        0x0400040004000000ULL, 0x0400040404000000ULL, 0x0400040004000004ULL, 0x0400040404000004ULL,
        0x0400000004000400ULL, 0x0400000404000400ULL, 0x0400000004000404ULL, 0x0400000404000404ULL,
        0x0400040004000400ULL, 0x0400040404000400ULL, 0x0400040004000404ULL, 0x0400040404000404ULL,
        0x0404000004000000ULL, 0x0404000404000000ULL, 0x0404000004000004ULL, 0x0404000404000004ULL,
        0x0404040004000000ULL, 0x0404040404000000ULL, 0x0404040004000004ULL, 0x0404040404000004ULL,
        0x0404000004000400ULL, 0x0404000404000400ULL, 0x0404000004000404ULL, 0x0404000404000404ULL,
        0x0404040004000400ULL, 0x0404040404000400ULL, 0x0404040004000404ULL, 0x0404040404000404ULL,
        0x0400000004040000ULL, 0x0400000404040000ULL, 0x0400000004040004ULL, 0x0400000404040004ULL,
        0x0400040004040000ULL, 0x0400040404040000ULL, 0x0400040004040004ULL, 0x0400040404040004ULL,
        0x0400000004040400ULL, 0x0400000404040400ULL, 0x0400000004040404ULL, 0x0400000404040404ULL,
        0x0400040004040400ULL, 0x0400040404040400ULL, 0x0400040004040404ULL, 0x0400040404040404ULL,
        0x0404000004040000ULL, 0x0404000404040000ULL, 0x0404000004040004ULL, 0x0404000404040004ULL,
        0x0404040004040000ULL, 0x0404040404040000ULL, 0x0404040004040004ULL, 0x0404040404040004ULL,
        0x0404000004040400ULL, 0x0404000404040400ULL, 0x0404000004040404ULL, 0x0404000404040404ULL,
        0x0404040004040400ULL, 0x0404040404040400ULL, 0x0404040004040404ULL, 0x0404040404040404ULL
    },
    {
        0x0000000000000000ULL, 0x0000000200000000ULL, 0x0000000000000002ULL, 0x0000000200000002ULL,
        0x0000020000000000ULL, 0x0000020200000000ULL, 0x0000020000000002ULL, 0x0000020200000002ULL,
        0x0000000000000200ULL, 0x0000000200000200ULL, 0x0000000000000202ULL, 0x0000000200000202ULL,
        0x0000020000000200ULL, 0x0000020200000200ULL, 0x0000020000000202ULL, 0x0000020200000202ULL,
        0x0002000000000000ULL, 0x0002000200000000ULL, 0x0002000000000002ULL, 0x0002000200000002ULL,
        0x0002020000000000ULL, 0x0002020200000000ULL, 0x0002020000000002ULL, 0x0002020200000002ULL,
        0x0002000000000200ULL, 0x0002000200000200ULL, 0x0002000000000202ULL, 0x0002000200000202ULL,
        0x0002020000000200ULL, 0x0002020200000200ULL, 0x0002020000000202ULL, 0x0002020200000202ULL,
        0x0000000000020000ULL, 0x0000000200020000ULL, 0x0000000000020002ULL, 0x0000000200020002ULL,
        0x0000020000020000ULL, 0x0000020200020000ULL, 0x0000020000020002ULL, 0x0000020200020002ULL,
        0x0000000000020200ULL, 0x0000000200020200ULL, 0x0000000000020202ULL, 0x0000000200020202ULL,
        0x0000020000020200ULL, 0x0000020200020200ULL, 0x0000020000020202ULL, 0x0000020200020202ULL,
        0x0002000000020000ULL, 0x0002000200020000ULL, 0x0002000000020002ULL, 0x0002000200020002ULL,
        0x0002020000020000ULL, 0x0002020200020000ULL, 0x0002020000020002ULL, 0x0002020200020002ULL,
        0x0002000000020200ULL, 0x0002000200020200ULL, 0x0002000000020202ULL, 0x0002000200020202ULL,
        0x0002020000020200ULL, 0x0002020200020200ULL, 0x0002020000020202ULL, 0x0002020200020202ULL,
        0x0200000000000000ULL, 0x0200000200000000ULL, 0x0200000000000002ULL, 0x0200000200000002ULL,
        0x0200020000000000ULL, 0x0200020200000000ULL, 0x0200020000000002ULL, 0x0200020200000002ULL,
        0x0200000000000200ULL, 0x0200000200000200ULL, 0x0200000000000202ULL, 0x0200000200000202ULL,
        0x0200020000000200ULL, 0x0200020200000200ULL, 0x0200020000000202ULL, 0x0200020200000202ULL,
        0x0202000000000000ULL, 0x0202000200000000ULL, 0x0202000000000002ULL, 0x0202000200000002ULL,
        0x0202020000000000ULL, 0x0202020200000000ULL, 0x0202020000000002ULL, 0x0202020200000002ULL,
        0x0202000000000200ULL, 0x0202000200000200ULL, 0x0202000000000202ULL, 0x0202000200000202ULL,
        0x0202020000000200ULL, 0x0202020200000200ULL, 0x0202020000000202ULL, 0x0202020200000202ULL,
        0x0200000000020000ULL, 0x0200000200020000ULL, 0x0200000000020002ULL, 0x0200000200020002ULL,
        0x0200020000020000ULL, 0x0200020200020000ULL, 0x0200020000020002ULL, 0x0200020200020002ULL,
        0x0200000000020200ULL, 0x0200000200020200ULL, 0x0200000000020202ULL, 0x0200000200020202ULL,
        0x0200020000020200ULL, 0x0200020200020200ULL, 0x0200020000020202ULL, 0x0200020200020202ULL,
        0x0202000000020000ULL, 0x0202000200020000ULL, 0x0202000000020002ULL, 0x0202000200020002ULL,
        0x0202020000020000ULL, 0x0202020200020000ULL, 0x0202020000020002ULL, 0x0202020200020002ULL,
        0x0202000000020200ULL, 0x0202000200020200ULL, 0x0202000000020202ULL, 0x0202000200020202ULL,
        0x0202020000020200ULL, 0x0202020200020200ULL, 0x0202020000020202ULL, 0x0202020200020202ULL,
        0x0000000002000000ULL, 0x0000000202000000ULL, 0x0000000002000002ULL, 0x0000000202000002ULL,
        0x0000020002000000ULL, 0x0000020202000000ULL, 0x0000020002000002ULL, 0x0000020202000002ULL,
        0x0000000002000200ULL, 0x0000000202000200ULL, 0x0000000002000202ULL, 0x0000000202000202ULL,
        0x0000020002000200ULL, 0x0000020202000200ULL, 0x0000020002000202ULL, 0x0000020202000202ULL,
        0x0002000002000000ULL, 0x0002000202000000ULL, 0x0002000002000002ULL, 0x0002000202000002ULL,
        0x0002020002000000ULL, 0x0002020202000000ULL, 0x0002020002000002ULL, 0x0002020202000002ULL,
        0x0002000002000200ULL, 0x0002000202000200ULL, 0x0002000002000202ULL, 0x0002000202000202ULL,
        0x0002020002000200ULL, 0x0002020202000200ULL, 0x0002020002000202ULL, 0x0002020202000202ULL,
        0x0000000002020000ULL, 0x0000000202020000ULL, 0x0000000002020002ULL, 0x0000000202020002ULL,
        0x0000020002020000ULL, 0x0000020202020000ULL, 0x0000020002020002ULL, 0x0000020202020002ULL,
        0x0000000002020200ULL, 0x0000000202020200ULL, 0x0000000002020202ULL, 0x0000000202020202ULL,
        0x0000020002020200ULL, 0x0000020202020200ULL, 0x0000020002020202ULL, 0x0000020202020202ULL,
        0x0002000002020000ULL, 0x0002000202020000ULL, 0x0002000002020002ULL, 0x0002000202020002ULL,
        0x0002020002020000ULL, 0x0002020202020000ULL, 0x0002020002020002ULL, 0x0002020202020002ULL,
        0x0002000002020200ULL, 0x0002000202020200ULL, 0x0002000002020202ULL, 0x0002000202020202ULL,
        0x0002020002020200ULL, 0x0002020202020200ULL, 0x0002020002020202ULL, 0x0002020202020202ULL,
        0x0200000002000000ULL, 0x0200000202000000ULL, 0x0200000002000002ULL, 0x0200000202000002ULL,
        0x0200020002000000ULL, 0x0200020202000000ULL, 0x0200020002000002ULL, 0x0200020202000002ULL,
        0x0200000002000200ULL, 0x0200000202000200ULL, 0x0200000002000202ULL, 0x0200000202000202ULL,
        0x0200020002000200ULL, 0x0200020202000200ULL, 0x0200020002000202ULL, 0x0200020202000202ULL,
        0x0202000002000000ULL, 0x0202000202000000ULL, 0x0202000002000002ULL, 0x0202000202000002ULL,
        0x0202020002000000ULL, 0x0202020202000000ULL, 0x0202020002000002ULL, 0x0202020202000002ULL,
        0x0202000002000200ULL, 0x0202000202000200ULL, 0x0202000002000202ULL, 0x0202000202000202ULL,
        0x0202020002000200ULL, 0x0202020202000200ULL, 0x0202020002000202ULL, 0x0202020202000202ULL,
        0x0200000002020000ULL, 0x0200000202020000ULL, 0x0200000002020002ULL, 0x0200000202020002ULL,
        0x0200020002020000ULL, 0x0200020202020000ULL, 0x0200020002020002ULL, 0x0200020202020002ULL,
        0x0200000002020200ULL, 0x0200000202020200ULL, 0x0200000002020202ULL, 0x0200000202020202ULL,
        0x0200020002020200ULL, 0x0200020202020200ULL, 0x0200020002020202ULL, 0x0200020202020202ULL,
        0x0202000002020000ULL, 0x0202000202020000ULL, 0x0202000002020002ULL, 0x0202000202020002ULL,
        0x0202020002020000ULL, 0x0202020202020000ULL, 0x0202020002020002ULL, 0x0202020202020002ULL,
        0x0202000002020200ULL, 0x0202000202020200ULL, 0x0202000002020202ULL, 0x0202000202020202ULL,
        0x0202020002020200ULL, 0x0202020202020200ULL, 0x0202020002020202ULL, 0x0202020202020202ULL
    },
    {
        0x0000000000000000ULL, 0x0000010000000000ULL, 0x0000000000000100ULL, 0x0000010000000100ULL,
        0x0001000000000000ULL, 0x0001010000000000ULL, 0x0001000000000100ULL, 0x0001010000000100ULL,
        0x0000000000010000ULL, 0x0000010000010000ULL, 0x0000000000010100ULL, 0x0000010000010100ULL,
        0x0001000000010000ULL, 0x0001010000010000ULL, 0x0001000000010100ULL, 0x0001010000010100ULL,
        0x0100000000000000ULL, 0x0100010000000000ULL, 0x0100000000000100ULL, 0x0100010000000100ULL,
        0x0101000000000000ULL, 0x0101010000000000ULL, 0x0101000000000100ULL, 0x0101010000000100ULL,
        0x0100000000010000ULL, 0x0100010000010000ULL, 0x0100000000010100ULL, 0x0100010000010100ULL,
        0x0101000000010000ULL, 0x0101010000010000ULL, 0x0101000000010100ULL, 0x0101010000010100ULL,
        0x0000000001000000ULL, 0x0000010001000000ULL, 0x0000000001000100ULL, 0x0000010001000100ULL,
        0x0001000001000000ULL, 0x0001010001000000ULL, 0x0001000001000100ULL, 0x0001010001000100ULL,
        0x0000000001010000ULL, 0x0000010001010000ULL, 0x0000000001010100ULL, 0x0000010001010100ULL,
        0x0001000001010000ULL, 0x0001010001010000ULL, 0x0001000001010100ULL, 0x0001010001010100ULL,
        0x0100000001000000ULL, 0x0100010001000000ULL, 0x0100000001000100ULL, 0x0100010001000100ULL,
        0x0101000001000000ULL, 0x0101010001000000ULL, 0x0101000001000100ULL, 0x0101010001000100ULL,
        0x0100000001010000ULL, 0x0100010001010000ULL, 0x0100000001010100ULL, 0x0100010001010100ULL,
        0x0101000001010000ULL, 0x0101010001010000ULL, 0x0101000001010100ULL, 0x0101010001010100ULL,
        0x0000000100000000ULL, 0x0000010100000000ULL, 0x0000000100000100ULL, 0x0000010100000100ULL,
        0x0001000100000000ULL, 0x0001010100000000ULL, 0x0001000100000100ULL, 0x0001010100000100ULL,
        0x0000000100010000ULL, 0x0000010100010000ULL, 0x0000000100010100ULL, 0x0000010100010100ULL,
        0x0001000100010000ULL, 0x0001010100010000ULL, 0x0001000100010100ULL, 0x0001010100010100ULL,
        0x0100000100000000ULL, 0x0100010100000000ULL, 0x0100000100000100ULL, 0x0100010100000100ULL,
        0x0101000100000000ULL, 0x0101010100000000ULL, 0x0101000100000100ULL, 0x0101010100000100ULL,
        0x0100000100010000ULL, 0x0100010100010000ULL, 0x0100000100010100ULL, 0x0100010100010100ULL,
        0x0101000100010000ULL, 0x0101010100010000ULL, 0x0101000100010100ULL, 0x0101010100010100ULL,
        0x0000000101000000ULL, 0x0000010101000000ULL, 0x0000000101000100ULL, 0x0000010101000100ULL,
        0x0001000101000000ULL, 0x0001010101000000ULL, 0x0001000101000100ULL, 0x0001010101000100ULL,
        0x0000000101010000ULL, 0x0000010101010000ULL, 0x0000000101010100ULL, 0x0000010101010100ULL,
        0x0001000101010000ULL, 0x0001010101010000ULL, 0x0001000101010100ULL, 0x0001010101010100ULL,
        0x0100000101000000ULL, 0x0100010101000000ULL, 0x0100000101000100ULL, 0x0100010101000100ULL,
        0x0101000101000000ULL, 0x0101010101000000ULL, 0x0101000101000100ULL, 0x0101010101000100ULL,
        0x0100000101010000ULL, 0x0100010101010000ULL, 0x0100000101010100ULL, 0x0100010101010100ULL,
        0x0101000101010000ULL, 0x0101010101010000ULL, 0x0101000101010100ULL, 0x0101010101010100ULL,
        0x0000000000000001ULL, 0x0000010000000001ULL, 0x0000000000000101ULL, 0x0000010000000101ULL,
        0x0001000000000001ULL, 0x0001010000000001ULL, 0x0001000000000101ULL, 0x0001010000000101ULL,
        0x0000000000010001ULL, 0x0000010000010001ULL, 0x0000000000010101ULL, 0x0000010000010101ULL,
        0x0001000000010001ULL, 0x0001010000010001ULL, 0x0001000000010101ULL, 0x0001010000010101ULL,
        0x0100000000000001ULL, 0x0100010000000001ULL, 0x0100000000000101ULL, 0x0100010000000101ULL,
        0x0101000000000001ULL, 0x0101010000000001ULL, 0x0101000000000101ULL, 0x0101010000000101ULL,
        0x0100000000010001ULL, 0x0100010000010001ULL, 0x0100000000010101ULL, 0x0100010000010101ULL,
        0x0101000000010001ULL, 0x0101010000010001ULL, 0x0101000000010101ULL, 0x0101010000010101ULL,
        0x0000000001000001ULL, 0x0000010001000001ULL, 0x0000000001000101ULL, 0x0000010001000101ULL,
        0x0001000001000001ULL, 0x0001010001000001ULL, 0x0001000001000101ULL, 0x0001010001000101ULL,
        0x0000000001010001ULL, 0x0000010001010001ULL, 0x0000000001010101ULL, 0x0000010001010101ULL,
        0x0001000001010001ULL, 0x0001010001010001ULL, 0x0001000001010101ULL, 0x0001010001010101ULL,
        0x0100000001000001ULL, 0x0100010001000001ULL, 0x0100000001000101ULL, 0x0100010001000101ULL,
        0x0101000001000001ULL, 0x0101010001000001ULL, 0x0101000001000101ULL, 0x0101010001000101ULL,
        0x0100000001010001ULL, 0x0100010001010001ULL, 0x0100000001010101ULL, 0x0100010001010101ULL,
        0x0101000001010001ULL, 0x0101010001010001ULL, 0x0101000001010101ULL, 0x0101010001010101ULL,
        0x0000000100000001ULL, 0x0000010100000001ULL, 0x0000000100000101ULL, 0x0000010100000101ULL,
        0x0001000100000001ULL, 0x0001010100000001ULL, 0x0001000100000101ULL, 0x0001010100000101ULL,
        0x0000000100010001ULL, 0x0000010100010001ULL, 0x0000000100010101ULL, 0x0000010100010101ULL,
        0x0001000100010001ULL, 0x0001010100010001ULL, 0x0001000100010101ULL, 0x0001010100010101ULL,
        0x0100000100000001ULL, 0x0100010100000001ULL, 0x0100000100000101ULL, 0x0100010100000101ULL,
        0x0101000100000001ULL, 0x0101010100000001ULL, 0x0101000100000101ULL, 0x0101010100000101ULL,
        0x0100000100010001ULL, 0x0100010100010001ULL, 0x0100000100010101ULL, 0x0100010100010101ULL,
        0x0101000100010001ULL, 0x0101010100010001ULL, 0x0101000100010101ULL, 0x0101010100010101ULL,
        0x0000000101000001ULL, 0x0000010101000001ULL, 0x0000000101000101ULL, 0x0000010101000101ULL,
        0x0001000101000001ULL, 0x0001010101000001ULL, 0x0001000101000101ULL, 0x0001010101000101ULL,
        0x0000000101010001ULL, 0x0000010101010001ULL, 0x0000000101010101ULL, 0x0000010101010101ULL,
        0x0001000101010001ULL, 0x0001010101010001ULL, 0x0001000101010101ULL, 0x0001010101010101ULL,
        0x0100000101000001ULL, 0x0100010101000001ULL, 0x0100000101000101ULL, 0x0100010101000101ULL,
        0x0101000101000001ULL, 0x0101010101000001ULL, 0x0101000101000101ULL, 0x0101010101000101ULL,
        0x0100000101010001ULL, 0x0100010101010001ULL, 0x0100000101010101ULL, 0x0100010101010101ULL,
        0x0101000101010001ULL, 0x0101010101010001ULL, 0x0101000101010101ULL, 0x0101010101010101ULL
    },
    {
        0x0000000000000000ULL, 0x0000008000000000ULL, 0x0000000000000080ULL, 0x0000008000000080ULL,
        0x0000800000000000ULL, 0x0000808000000000ULL, 0x0000800000000080ULL, 0x0000808000000080ULL,
        0x0000000000008000ULL, 0x0000008000008000ULL, 0x0000000000008080ULL, 0x0000008000008080ULL,
        0x0000800000008000ULL, 0x0000808000008000ULL, 0x0000800000008080ULL, 0x0000808000008080ULL,
        0x0080000000000000ULL, 0x0080008000000000ULL, 0x0080000000000080ULL, 0x0080008000000080ULL,
        0x0080800000000000ULL, 0x0080808000000000ULL, 0x0080800000000080ULL, 0x0080808000000080ULL,
        0x0080000000008000ULL, 0x0080008000008000ULL, 0x0080000000008080ULL, 0x0080008000008080ULL,
        0x0080800000008000ULL, 0x0080808000008000ULL, 0x0080800000008080ULL, 0x0080808000008080ULL,
        0x0000000000800000ULL, 0x0000008000800000ULL, 0x0000000000800080ULL, 0x0000008000800080ULL,
        0x0000800000800000ULL, 0x0000808000800000ULL, 0x0000800000800080ULL, 0x0000808000800080ULL,
        0x0000000000808000ULL, 0x0000008000808000ULL, 0x0000000000808080ULL, 0x0000008000808080ULL,
        0x0000800000808000ULL, 0x0000808000808000ULL, 0x0000800000808080ULL, 0x0000808000808080ULL,
        0x0080000000800000ULL, 0x0080008000800000ULL, 0x0080000000800080ULL, 0x0080008000800080ULL,
        0x0080800000800000ULL, 0x0080808000800000ULL, 0x0080800000800080ULL, 0x0080808000800080ULL,
        0x0080000000808000ULL, 0x0080008000808000ULL, 0x0080000000808080ULL, 0x0080008000808080ULL,
        0x0080800000808000ULL, 0x0080808000808000ULL, 0x0080800000808080ULL, 0x0080808000808080ULL,
        0x8000000000000000ULL, 0x8000008000000000ULL, 0x8000000000000080ULL, 0x8000008000000080ULL,
        0x8000800000000000ULL, 0x8000808000000000ULL, 0x8000800000000080ULL, 0x8000808000000080ULL,
        0x8000000000008000ULL, 0x8000008000008000ULL, 0x8000000000008080ULL, 0x8000008000008080ULL,
        0x8000800000008000ULL, 0x8000808000008000ULL, 0x8000800000008080ULL, 0x8000808000008080ULL,
        0x8080000000000000ULL, 0x8080008000000000ULL, 0x8080000000000080ULL, 0x8080008000000080ULL,
        0x8080800000000000ULL, 0x8080808000000000ULL, 0x8080800000000080ULL, 0x8080808000000080ULL,
        0x8080000000008000ULL, 0x8080008000008000ULL, 0x8080000000008080ULL, 0x8080008000008080ULL,
        0x8080800000008000ULL, 0x8080808000008000ULL, 0x8080800000008080ULL, 0x8080808000008080ULL,
        0x8000000000800000ULL, 0x8000008000800000ULL, 0x8000000000800080ULL, 0x8000008000800080ULL,
        0x8000800000800000ULL, 0x8000808000800000ULL, 0x8000800000800080ULL, 0x8000808000800080ULL,
        0x8000000000808000ULL, 0x8000008000808000ULL, 0x8000000000808080ULL, 0x8000008000808080ULL,
        0x8000800000808000ULL, 0x8000808000808000ULL, 0x8000800000808080ULL, 0x8000808000808080ULL,
        0x8080000000800000ULL, 0x8080008000800000ULL, 0x8080000000800080ULL, 0x8080008000800080ULL,
        0x8080800000800000ULL, 0x8080808000800000ULL, 0x8080800000800080ULL, 0x8080808000800080ULL,
        0x8080000000808000ULL, 0x8080008000808000ULL, 0x8080000000808080ULL, 0x8080008000808080ULL,
        0x8080800000808000ULL, 0x8080808000808000ULL, 0x8080800000808080ULL, 0x8080808000808080ULL,
        0x0000000080000000ULL, 0x0000008080000000ULL, 0x0000000080000080ULL, 0x0000008080000080ULL,
        0x0000800080000000ULL, 0x0000808080000000ULL, 0x0000800080000080ULL, 0x0000808080000080ULL,
        0x0000000080008000ULL, 0x0000008080008000ULL, 0x0000000080008080ULL, 0x0000008080008080ULL,
        0x0000800080008000ULL, 0x0000808080008000ULL, 0x0000800080008080ULL, 0x0000808080008080ULL,
        0x0080000080000000ULL, 0x0080008080000000ULL, 0x0080000080000080ULL, 0x0080008080000080ULL,
        0x0080800080000000ULL, 0x0080808080000000ULL, 0x0080800080000080ULL, 0x0080808080000080ULL,
        0x0080000080008000ULL, 0x0080008080008000ULL, 0x0080000080008080ULL, 0x0080008080008080ULL,
        0x0080800080008000ULL, 0x0080808080008000ULL, 0x0080800080008080ULL, 0x0080808080008080ULL,
        0x0000000080800000ULL, 0x0000008080800000ULL, 0x0000000080800080ULL, 0x0000008080800080ULL,
        0x0000800080800000ULL, 0x0000808080800000ULL, 0x0000800080800080ULL, 0x0000808080800080ULL,
        0x0000000080808000ULL, 0x0000008080808000ULL, 0x0000000080808080ULL, 0x0000008080808080ULL,
        0x0000800080808000ULL, 0x0000808080808000ULL, 0x0000800080808080ULL, 0x0000808080808080ULL,
        0x0080000080800000ULL, 0x0080008080800000ULL, 0x0080000080800080ULL, 0x0080008080800080ULL,
        0x0080800080800000ULL, 0x0080808080800000ULL, 0x0080800080800080ULL, 0x0080808080800080ULL,
        0x0080000080808000ULL, 0x0080008080808000ULL, 0x0080000080808080ULL, 0x0080008080808080ULL,
        0x0080800080808000ULL, 0x0080808080808000ULL, 0x0080800080808080ULL, 0x0080808080808080ULL,
        0x8000000080000000ULL, 0x8000008080000000ULL, 0x8000000080000080ULL, 0x8000008080000080ULL,
        0x8000800080000000ULL, 0x8000808080000000ULL, 0x8000800080000080ULL, 0x8000808080000080ULL,
        0x8000000080008000ULL, 0x8000008080008000ULL, 0x8000000080008080ULL, 0x8000008080008080ULL,
        0x8000800080008000ULL, 0x8000808080008000ULL, 0x8000800080008080ULL, 0x8000808080008080ULL,
        0x8080000080000000ULL, 0x8080008080000000ULL, 0x8080000080000080ULL, 0x8080008080000080ULL,
        0x8080800080000000ULL, 0x8080808080000000ULL, 0x8080800080000080ULL, 0x8080808080000080ULL,
        0x8080000080008000ULL, 0x8080008080008000ULL, 0x8080000080008080ULL, 0x8080008080008080ULL,
        0x8080800080008000ULL, 0x8080808080008000ULL, 0x8080800080008080ULL, 0x8080808080008080ULL,
        0x8000000080800000ULL, 0x8000008080800000ULL, 0x8000000080800080ULL, 0x8000008080800080ULL,
        0x8000800080800000ULL, 0x8000808080800000ULL, 0x8000800080800080ULL, 0x8000808080800080ULL,
        0x8000000080808000ULL, 0x8000008080808000ULL, 0x8000000080808080ULL, 0x8000008080808080ULL,
        0x8000800080808000ULL, 0x8000808080808000ULL, 0x8000800080808080ULL, 0x8000808080808080ULL,
        0x8080000080800000ULL, 0x8080008080800000ULL, 0x8080000080800080ULL, 0x8080008080800080ULL,
        0x8080800080800000ULL, 0x8080808080800000ULL, 0x8080800080800080ULL, 0x8080808080800080ULL,
        0x8080000080808000ULL, 0x8080008080808000ULL, 0x8080000080808080ULL, 0x8080008080808080ULL,
        0x8080800080808000ULL, 0x8080808080808000ULL, 0x8080800080808080ULL, 0x8080808080808080ULL
    },
    {
        0x0000000000000000ULL, 0x0000004000000000ULL, 0x0000000000000040ULL, 0x0000004000000040ULL,
        0x0000400000000000ULL, 0x0000404000000000ULL, 0x0000400000000040ULL, 0x0000404000000040ULL,
        0x0000000000004000ULL, 0x0000004000004000ULL, 0x0000000000004040ULL, 0x0000004000004040ULL,
        0x0000400000004000ULL, 0x0000404000004000ULL, 0x0000400000004040ULL, 0x0000404000004040ULL,
        0x0040000000000000ULL, 0x0040004000000000ULL, 0x0040000000000040ULL, 0x0040004000000040ULL,
        0x0040400000000000ULL, 0x0040404000000000ULL, 0x0040400000000040ULL, 0x0040404000000040ULL,
        0x0040000000004000ULL, 0x0040004000004000ULL, 0x0040000000004040ULL, 0x0040004000004040ULL,
        0x0040400000004000ULL, 0x0040404000004000ULL, 0x0040400000004040ULL, 0x0040404000004040ULL,
        0x0000000000400000ULL, 0x0000004000400000ULL, 0x0000000000400040ULL, 0x0000004000400040ULL,
        0x0000400000400000ULL, 0x0000404000400000ULL, 0x0000400000400040ULL, 0x0000404000400040ULL,
        0x0000000000404000ULL, 0x0000004000404000ULL, 0x0000000000404040ULL, 0x0000004000404040ULL,
        0x0000400000404000ULL, 0x0000404000404000ULL, 0x0000400000404040ULL, 0x0000404000404040ULL,
        0x0040000000400000ULL, 0x0040004000400000ULL, 0x0040000000400040ULL, 0x0040004000400040ULL,
        0x0040400000400000ULL, 0x0040404000400000ULL, 0x0040400000400040ULL, 0x0040404000400040ULL,
        0x0040000000404000ULL, 0x0040004000404000ULL, 0x0040000000404040ULL, 0x0040004000404040ULL,
        0x0040400000404000ULL, 0x0040404000404000ULL, 0x0040400000404040ULL, 0x0040404000404040ULL,
        0x4000000000000000ULL, 0x4000004000000000ULL, 0x4000000000000040ULL, 0x4000004000000040ULL,
        0x4000400000000000ULL, 0x4000404000000000ULL, 0x4000400000000040ULL, 0x4000404000000040ULL,
        0x4000000000004000ULL, 0x4000004000004000ULL, 0x4000000000004040ULL, 0x4000004000004040ULL,
        0x4000400000004000ULL, 0x4000404000004000ULL, 0x4000400000004040ULL, 0x4000404000004040ULL,
        0x4040000000000000ULL, 0x4040004000000000ULL, 0x4040000000000040ULL, 0x4040004000000040ULL,
        0x4040400000000000ULL, 0x4040404000000000ULL, 0x4040400000000040ULL, 0x4040404000000040ULL,
        0x4040000000004000ULL, 0x4040004000004000ULL, 0x4040000000004040ULL, 0x4040004000004040ULL,
        0x4040400000004000ULL, 0x4040404000004000ULL, 0x4040400000004040ULL, 0x4040404000004040ULL,
        0x4000000000400000ULL, 0x4000004000400000ULL, 0x4000000000400040ULL, 0x4000004000400040ULL,
        0x4000400000400000ULL, 0x4000404000400000ULL, 0x4000400000400040ULL, 0x4000404000400040ULL,
        0x4000000000404000ULL, 0x4000004000404000ULL, 0x4000000000404040ULL, 0x4000004000404040ULL,
        0x4000400000404000ULL, 0x4000404000404000ULL, 0x4000400000404040ULL, 0x4000404000404040ULL,
        0x4040000000400000ULL, 0x4040004000400000ULL, 0x4040000000400040ULL, 0x4040004000400040ULL,
        0x4040400000400000ULL, 0x4040404000400000ULL, 0x4040400000400040ULL, 0x4040404000400040ULL,
        0x4040000000404000ULL, 0x4040004000404000ULL, 0x4040000000404040ULL, 0x4040004000404040ULL,
        0x4040400000404000ULL, 0x4040404000404000ULL, 0x4040400000404040ULL, 0x4040404000404040ULL,
        0x0000000040000000ULL, 0x0000004040000000ULL, 0x0000000040000040ULL, 0x0000004040000040ULL,
        0x0000400040000000ULL, 0x0000404040000000ULL, 0x0000400040000040ULL, 0x0000404040000040ULL,
        0x0000000040004000ULL, 0x0000004040004000ULL, 0x0000000040004040ULL, 0x0000004040004040ULL,
        0x0000400040004000ULL, 0x0000404040004000ULL, 0x0000400040004040ULL, 0x0000404040004040ULL,
        0x0040000040000000ULL, 0x0040004040000000ULL, 0x0040000040000040ULL, 0x0040004040000040ULL,
        0x0040400040000000ULL, 0x0040404040000000ULL, 0x0040400040000040ULL, 0x0040404040000040ULL,
        0x0040000040004000ULL, 0x0040004040004000ULL, 0x0040000040004040ULL, 0x0040004040004040ULL,
        0x0040400040004000ULL, 0x0040404040004000ULL, 0x0040400040004040ULL, 0x0040404040004040ULL,
        0x0000000040400000ULL, 0x0000004040400000ULL, 0x0000000040400040ULL, 0x0000004040400040ULL,
        0x0000400040400000ULL, 0x0000404040400000ULL, 0x0000400040400040ULL, 0x0000404040400040ULL,
        0x0000000040404000ULL, 0x0000004040404000ULL, 0x0000000040404040ULL, 0x0000004040404040ULL,
        0x0000400040404000ULL, 0x0000404040404000ULL, 0x0000400040404040ULL, 0x0000404040404040ULL,
        0x0040000040400000ULL, 0x0040004040400000ULL, 0x0040000040400040ULL, 0x0040004040400040ULL,
        0x0040400040400000ULL, 0x0040404040400000ULL, 0x0040400040400040ULL, 0x0040404040400040ULL,
        0x0040000040404000ULL, 0x0040004040404000ULL, 0x0040000040404040ULL, 0x0040004040404040ULL,
        0x0040400040404000ULL, 0x0040404040404000ULL, 0x0040400040404040ULL, 0x0040404040404040ULL,
        0x4000000040000000ULL, 0x4000004040000000ULL, 0x4000000040000040ULL, 0x4000004040000040ULL,
        0x4000400040000000ULL, 0x4000404040000000ULL, 0x4000400040000040ULL, 0x4000404040000040ULL,
        0x4000000040004000ULL, 0x4000004040004000ULL, 0x4000000040004040ULL, 0x4000004040004040ULL,
        0x4000400040004000ULL, 0x4000404040004000ULL, 0x4000400040004040ULL, 0x4000404040004040ULL,
        0x4040000040000000ULL, 0x4040004040000000ULL, 0x4040000040000040ULL, 0x4040004040000040ULL,
        0x4040400040000000ULL, 0x4040404040000000ULL, 0x4040400040000040ULL, 0x4040404040000040ULL,
        0x4040000040004000ULL, 0x4040004040004000ULL, 0x4040000040004040ULL, 0x4040004040004040ULL,
        0x4040400040004000ULL, 0x4040404040004000ULL, 0x4040400040004040ULL, 0x4040404040004040ULL,
        0x4000000040400000ULL, 0x4000004040400000ULL, 0x4000000040400040ULL, 0x4000004040400040ULL,
        0x4000400040400000ULL, 0x4000404040400000ULL, 0x4000400040400040ULL, 0x4000404040400040ULL,
        0x4000000040404000ULL, 0x4000004040404000ULL, 0x4000000040404040ULL, 0x4000004040404040ULL,
        0x4000400040404000ULL, 0x4000404040404000ULL, 0x4000400040404040ULL, 0x4000404040404040ULL,
        0x4040000040400000ULL, 0x4040004040400000ULL, 0x4040000040400040ULL, 0x4040004040400040ULL,
        0x4040400040400000ULL, 0x4040404040400000ULL, 0x4040400040400040ULL, 0x4040404040400040ULL,
        0x4040000040404000ULL, 0x4040004040404000ULL, 0x4040000040404040ULL, 0x4040004040404040ULL,
        0x4040400040404000ULL, 0x4040404040404000ULL, 0x4040400040404040ULL, 0x4040404040404040ULL
    },
    {
        0x0000000000000000ULL, 0x0000002000000000ULL, 0x0000000000000020ULL, 0x0000002000000020ULL,
        0x0000200000000000ULL, 0x0000202000000000ULL, 0x0000200000000020ULL, 0x0000202000000020ULL,
        0x0000000000002000ULL, 0x0000002000002000ULL, 0x0000000000002020ULL, 0x0000002000002020ULL,
        0x0000200000002000ULL, 0x0000202000002000ULL, 0x0000200000002020ULL, 0x0000202000002020ULL,
        0x0020000000000000ULL, 0x0020002000000000ULL, 0x0020000000000020ULL, 0x0020002000000020ULL,
        0x0020200000000000ULL, 0x0020202000000000ULL, 0x0020200000000020ULL, 0x0020202000000020ULL,
        0x0020000000002000ULL, 0x0020002000002000ULL, 0x0020000000002020ULL, 0x0020002000002020ULL,
        0x0020200000002000ULL, 0x0020202000002000ULL, 0x0020200000002020ULL, 0x0020202000002020ULL,
        0x0000000000200000ULL, 0x0000002000200000ULL, 0x0000000000200020ULL, 0x0000002000200020ULL,
        0x0000200000200000ULL, 0x0000202000200000ULL, 0x0000200000200020ULL, 0x0000202000200020ULL,
        0x0000000000202000ULL, 0x0000002000202000ULL, 0x0000000000202020ULL, 0x0000002000202020ULL,
        0x0000200000202000ULL, 0x0000202000202000ULL, 0x0000200000202020ULL, 0x0000202000202020ULL,
        0x0020000000200000ULL, 0x0020002000200000ULL, 0x0020000000200020ULL, 0x0020002000200020ULL,
        0x0020200000200000ULL, 0x0020202000200000ULL, 0x0020200000200020ULL, 0x0020202000200020ULL,
        0x0020000000202000ULL, 0x0020002000202000ULL, 0x0020000000202020ULL, 0x0020002000202020ULL,
        0x0020200000202000ULL, 0x0020202000202000ULL, 0x0020200000202020ULL, 0x0020202000202020ULL,
        0x2000000000000000ULL, 0x2000002000000000ULL, 0x2000000000000020ULL, 0x2000002000000020ULL,
        0x2000200000000000ULL, 0x2000202000000000ULL, 0x2000200000000020ULL, 0x2000202000000020ULL,
        0x2000000000002000ULL, 0x2000002000002000ULL, 0x2000000000002020ULL, 0x2000002000002020ULL,
        0x2000200000002000ULL, 0x2000202000002000ULL, 0x2000200000002020ULL, 0x2000202000002020ULL,
        0x2020000000000000ULL, 0x2020002000000000ULL, 0x2020000000000020ULL, 0x2020002000000020ULL,
        0x2020200000000000ULL, 0x2020202000000000ULL, 0x2020200000000020ULL, 0x2020202000000020ULL,
        0x2020000000002000ULL, 0x2020002000002000ULL, 0x2020000000002020ULL, 0x2020002000002020ULL,
        0x2020200000002000ULL, 0x2020202000002000ULL, 0x2020200000002020ULL, 0x2020202000002020ULL,
        0x2000000000200000ULL, 0x2000002000200000ULL, 0x2000000000200020ULL, 0x2000002000200020ULL,
        0x2000200000200000ULL, 0x2000202000200000ULL, 0x2000200000200020ULL, 0x2000202000200020ULL,
        0x2000000000202000ULL, 0x2000002000202000ULL, 0x2000000000202020ULL, 0x2000002000202020ULL,
        0x2000200000202000ULL, 0x2000202000202000ULL, 0x2000200000202020ULL, 0x2000202000202020ULL,
        0x2020000000200000ULL, 0x2020002000200000ULL, 0x2020000000200020ULL, 0x2020002000200020ULL,
        0x2020200000200000ULL, 0x2020202000200000ULL, 0x2020200000200020ULL, 0x2020202000200020ULL,
        0x2020000000202000ULL, 0x2020002000202000ULL, 0x2020000000202020ULL, 0x2020002000202020ULL,
        0x2020200000202000ULL, 0x2020202000202000ULL, 0x2020200000202020ULL, 0x2020202000202020ULL,
        0x0000000020000000ULL, 0x0000002020000000ULL, 0x0000000020000020ULL, 0x0000002020000020ULL,
        0x0000200020000000ULL, 0x0000202020000000ULL, 0x0000200020000020ULL, 0x0000202020000020ULL,
        0x0000000020002000ULL, 0x0000002020002000ULL, 0x0000000020002020ULL, 0x0000002020002020ULL,
        0x0000200020002000ULL, 0x0000202020002000ULL, 0x0000200020002020ULL, 0x0000202020002020ULL,
        0x0020000020000000ULL, 0x0020002020000000ULL, 0x0020000020000020ULL, 0x0020002020000020ULL,
        0x0020200020000000ULL, 0x0020202020000000ULL, 0x0020200020000020ULL, 0x0020202020000020ULL,
        0x0020000020002000ULL, 0x0020002020002000ULL, 0x0020000020002020ULL, 0x0020002020002020ULL,
        0x0020200020002000ULL, 0x0020202020002000ULL, 0x0020200020002020ULL, 0x0020202020002020ULL,
        0x0000000020200000ULL, 0x0000002020200000ULL, 0x0000000020200020ULL, 0x0000002020200020ULL,
        0x0000200020200000ULL, 0x0000202020200000ULL, 0x0000200020200020ULL, 0x0000202020200020ULL,
        0x0000000020202000ULL, 0x0000002020202000ULL, 0x0000000020202020ULL, 0x0000002020202020ULL,
        0x0000200020202000ULL, 0x0000202020202000ULL, 0x0000200020202020ULL, 0x0000202020202020ULL,
        0x0020000020200000ULL, 0x0020002020200000ULL, 0x0020000020200020ULL, 0x0020002020200020ULL,
        0x0020200020200000ULL, 0x0020202020200000ULL, 0x0020200020200020ULL, 0x0020202020200020ULL,
        0x0020000020202000ULL, 0x0020002020202000ULL, 0x0020000020202020ULL, 0x0020002020202020ULL,
        0x0020200020202000ULL, 0x0020202020202000ULL, 0x0020200020202020ULL, 0x0020202020202020ULL,
        0x2000000020000000ULL, 0x2000002020000000ULL, 0x2000000020000020ULL, 0x2000002020000020ULL,
        0x2000200020000000ULL, 0x2000202020000000ULL, 0x2000200020000020ULL, 0x2000202020000020ULL,
        0x2000000020002000ULL, 0x2000002020002000ULL, 0x2000000020002020ULL, 0x2000002020002020ULL,
        0x2000200020002000ULL, 0x2000202020002000ULL, 0x2000200020002020ULL, 0x2000202020002020ULL,
        0x2020000020000000ULL, 0x2020002020000000ULL, 0x2020000020000020ULL, 0x2020002020000020ULL,
        0x2020200020000000ULL, 0x2020202020000000ULL, 0x2020200020000020ULL, 0x2020202020000020ULL,
        0x2020000020002000ULL, 0x2020002020002000ULL, 0x2020000020002020ULL, 0x2020002020002020ULL,
        0x2020200020002000ULL, 0x2020202020002000ULL, 0x2020200020002020ULL, 0x2020202020002020ULL,
        0x2000000020200000ULL, 0x2000002020200000ULL, 0x2000000020200020ULL, 0x2000002020200020ULL,
        0x2000200020200000ULL, 0x2000202020200000ULL, 0x2000200020200020ULL, 0x2000202020200020ULL,
        0x2000000020202000ULL, 0x2000002020202000ULL, 0x2000000020202020ULL, 0x2000002020202020ULL,
        0x2000200020202000ULL, 0x2000202020202000ULL, 0x2000200020202020ULL, 0x2000202020202020ULL,
        0x2020000020200000ULL, 0x2020002020200000ULL, 0x2020000020200020ULL, 0x2020002020200020ULL,
        0x2020200020200000ULL, 0x2020202020200000ULL, 0x2020200020200020ULL, 0x2020202020200020ULL,
        0x2020000020202000ULL, 0x2020002020202000ULL, 0x2020000020202020ULL, 0x2020002020202020ULL,
        0x2020200020202000ULL, 0x2020202020202000ULL, 0x2020200020202020ULL, 0x2020202020202020ULL
    }
};

static const uint64_t des_fp[8][256] = {

    {
        0x0000000000000000ULL, 0x0000008000000000ULL, 0x0000000002000000ULL, 0x0000008002000000ULL,
        0x0000000000020000ULL, 0x0000008000020000ULL, 0x0000000002020000ULL, 0x0000008002020000ULL,
        0x0000000000000200ULL, 0x0000008000000200ULL, 0x0000000002000200ULL, 0x0000008002000200ULL,
        0x0000000000020200ULL, 0x0000008000020200ULL, 0x0000000002020200ULL, 0x0000008002020200ULL,
        0x0000000000000002ULL, 0x0000008000000002ULL, 0x0000000002000002ULL, 0x0000008002000002ULL,
        0x0000000000020002ULL, 0x0000008000020002ULL, 0x0000000002020002ULL, 0x0000008002020002ULL,
        0x0000000000000202ULL, 0x0000008000000202ULL, 0x0000000002000202ULL, 0x0000008002000202ULL,
        0x0000000000020202ULL, 0x0000008000020202ULL, 0x0000000002020202ULL, 0x0000008002020202ULL,
        0x0200000000000000ULL, 0x0200008000000000ULL, 0x0200000002000000ULL, 0x0200008002000000ULL,
        0x0200000000020000ULL, 0x0200008000020000ULL, 0x0200000002020000ULL, 0x0200008002020000ULL,
        0x0200000000000200ULL, 0x0200008000000200ULL, 0x0200000002000200ULL, 0x0200008002000200ULL,
        0x0200000000020200ULL, 0x0200008000020200ULL, 0x0200000002020200ULL, 0x0200008002020200ULL,
        0x0200000000000002ULL, 0x0200008000000002ULL, 0x0200000002000002ULL, 0x0200008002000002ULL,
        0x0200000000020002ULL, 0x0200008000020002ULL, 0x0200000002020002ULL, 0x0200008002020002ULL,
        0x0200000000000202ULL, 0x0200008000000202ULL, 0x0200000002000202ULL, 0x0200008002000202ULL,
        0x0200000000020202ULL, 0x0200008000020202ULL, 0x0200000002020202ULL, 0x0200008002020202ULL,
        0x0002000000000000ULL, 0x0002008000000000ULL, 0x0002000002000000ULL, 0x0002008002000000ULL,
        0x0002000000020000ULL, 0x0002008000020000ULL, 0x0002000002020000ULL, 0x0002008002020000ULL,
        0x0002000000000200ULL, 0x0002008000000200ULL, 0x0002000002000200ULL, 0x0002008002000200ULL,
        0x0002000000020200ULL, 0x0002008000020200ULL, 0x0002000002020200ULL, 0x0002008002020200ULL,
        0x0002000000000002ULL, 0x0002008000000002ULL, 0x0002000002000002ULL, 0x0002008002000002ULL,
        0x0002000000020002ULL, 0x0002008000020002ULL, 0x0002000002020002ULL, 0x0002008002020002ULL,
        0x0002000000000202ULL, 0x0002008000000202ULL, 0x0002000002000202ULL, 0x0002008002000202ULL,
        0x0002000000020202ULL, 0x0002008000020202ULL, 0x0002000002020202ULL, 0x0002008002020202ULL,
        0x0202000000000000ULL, 0x0202008000000000ULL, 0x0202000002000000ULL, 0x0202008002000000ULL,
        0x0202000000020000ULL, 0x0202008000020000ULL, 0x0202000002020000ULL, 0x0202008002020000ULL,
        0x0202000000000200ULL, 0x0202008000000200ULL, 0x0202000002000200ULL, 0x0202008002000200ULL,
        0x0202000000020200ULL, 0x0202008000020200ULL, 0x0202000002020200ULL, 0x0202008002020200ULL,
        0x0202000000000002ULL, 0x0202008000000002ULL, 0x0202000002000002ULL, 0x0202008002000002ULL,
        0x0202000000020002ULL, 0x0202008000020002ULL, 0x0202000002020002ULL, 0x0202008002020002ULL,
        0x0202000000000202ULL, 0x0202008000000202ULL, 0x0202000002000202ULL, 0x0202008002000202ULL,
        0x0202000000020202ULL, 0x0202008000020202ULL, 0x0202000002020202ULL, 0x0202008002020202ULL,
        0x0000020000000000ULL, 0x0000028000000000ULL, 0x0000020002000000ULL, 0x0000028002000000ULL,
        0x0000020000020000ULL, 0x0000028000020000ULL, 0x0000020002020000ULL, 0x0000028002020000ULL,
        0x0000020000000200ULL, 0x0000028000000200ULL, 0x0000020002000200ULL, 0x0000028002000200ULL,
        0x0000020000020200ULL, 0x0000028000020200ULL, 0x0000020002020200ULL, 0x0000028002020200ULL,
        0x0000020000000002ULL, 0x0000028000000002ULL, 0x0000020002000002ULL, 0x0000028002000002ULL,
        0x0000020000020002ULL, 0x0000028000020002ULL, 0x0000020002020002ULL, 0x0000028002020002ULL,
        0x0000020000000202ULL, 0x0000028000000202ULL, 0x0000020002000202ULL, 0x0000028002000202ULL,
        0x0000020000020202ULL, 0x0000028000020202ULL, 0x0000020002020202ULL, 0x0000028002020202ULL,
        0x0200020000000000ULL, 0x0200028000000000ULL, 0x0200020002000000ULL, 0x0200028002000000ULL,
        0x0200020000020000ULL, 0x0200028000020000ULL, 0x0200020002020000ULL, 0x0200028002020000ULL,
        0x0200020000000200ULL, 0x0200028000000200ULL, 0x0200020002000200ULL, 0x0200028002000200ULL,
        0x0200020000020200ULL, 0x0200028000020200ULL, 0x0200020002020200ULL, 0x0200028002020200ULL,
        0x0200020000000002ULL, 0x0200028000000002ULL, 0x0200020002000002ULL, 0x0200028002000002ULL,
        0x0200020000020002ULL, 0x0200028000020002ULL, 0x0200020002020002ULL, 0x0200028002020002ULL,
        0x0200020000000202ULL, 0x0200028000000202ULL, 0x0200020002000202ULL, 0x0200028002000202ULL,
        0x0200020000020202ULL, 0x0200028000020202ULL, 0x0200020002020202ULL, 0x0200028002020202ULL,
        0x0002020000000000ULL, 0x0002028000000000ULL, 0x0002020002000000ULL, 0x0002028002000000ULL,
        0x0002020000020000ULL, 0x0002028000020000ULL, 0x0002020002020000ULL, 0x0002028002020000ULL,
        0x0002020000000200ULL, 0x0002028000000200ULL, 0x0002020002000200ULL, 0x0002028002000200ULL,
        0x0002020000020200ULL, 0x0002028000020200ULL, 0x0002020002020200ULL, 0x0002028002020200ULL,
        0x0002020000000002ULL, 0x0002028000000002ULL, 0x0002020002000002ULL, 0x0002028002000002ULL,
        0x0002020000020002ULL, 0x0002028000020002ULL, 0x0002020002020002ULL, 0x0002028002020002ULL,
        0x0002020000000202ULL, 0x0002028000000202ULL, 0x0002020002000202ULL, 0x0002028002000202ULL,
        0x0002020000020202ULL, 0x0002028000020202ULL, 0x0002020002020202ULL, 0x0002028002020202ULL,
        0x0202020000000000ULL, 0x0202028000000000ULL, 0x0202020002000000ULL, 0x0202028002000000ULL,
        0x0202020000020000ULL, 0x0202028000020000ULL, 0x0202020002020000ULL, 0x0202028002020000ULL,
        0x0202020000000200ULL, 0x0202028000000200ULL, 0x0202020002000200ULL, 0x0202028002000200ULL,
        0x0202020000020200ULL, 0x0202028000020200ULL, 0x0202020002020200ULL, 0x0202028002020200ULL,
        0x0202020000000002ULL, 0x0202028000000002ULL, 0x0202020002000002ULL, 0x0202028002000002ULL,
        0x0202020000020002ULL, 0x0202028000020002ULL, 0x0202020002020002ULL, 0x0202028002020002ULL,
        0x0202020000000202ULL, 0x0202028000000202ULL, 0x0202020002000202ULL, 0x0202028002000202ULL,
        0x0202020000020202ULL, 0x0202028000020202ULL, 0x0202020002020202ULL, 0x0202028002020202ULL
    },
    {
        0x0000000000000000ULL, 0x0000000200000000ULL, 0x0000000008000000ULL, 0x0000000208000000ULL,
        0x0000000000080000ULL, 0x0000000200080000ULL, 0x0000000008080000ULL, 0x0000000208080000ULL,
        0x0000000000000800ULL, 0x0000000200000800ULL, 0x0000000008000800ULL, 0x0000000208000800ULL,
        0x0000000000080800ULL, 0x0000000200080800ULL, 0x0000000008080800ULL, 0x0000000208080800ULL,
        0x0000000000000008ULL, 0x0000000200000008ULL, 0x0000000008000008ULL, 0x0000000208000008ULL,
        0x0000000000080008ULL, 0x0000000200080008ULL, 0x0000000008080008ULL, 0x0000000208080008ULL,
        0x0000000000000808ULL, 0x0000000200000808ULL, 0x0000000008000808ULL, 0x0000000208000808ULL,
        0x0000000000080808ULL, 0x0000000200080808ULL, 0x0000000008080808ULL, 0x0000000208080808ULL,
        0x0800000000000000ULL, 0x0800000200000000ULL, 0x0800000008000000ULL, 0x0800000208000000ULL,
        0x0800000000080000ULL, 0x0800000200080000ULL, 0x0800000008080000ULL, 0x0800000208080000ULL,
        0x0800000000000800ULL, 0x0800000200000800ULL, 0x0800000008000800ULL, 0x0800000208000800ULL,
        0x0800000000080800ULL, 0x0800000200080800ULL, 0x0800000008080800ULL, 0x0800000208080800ULL,
        0x0800000000000008ULL, 0x0800000200000008ULL, 0x0800000008000008ULL, 0x0800000208000008ULL,
        0x0800000000080008ULL, 0x0800000200080008ULL, 0x0800000008080008ULL, 0x0800000208080008ULL,
        0x0800000000000808ULL, 0x0800000200000808ULL, 0x0800000008000808ULL, 0x0800000208000808ULL,
        0x0800000000080808ULL, 0x0800000200080808ULL, 0x0800000008080808ULL, 0x0800000208080808ULL,
        0x0008000000000000ULL, 0x0008000200000000ULL, 0x0008000008000000ULL, 0x0008000208000000ULL,
        0x0008000000080000ULL, 0x0008000200080000ULL, 0x0008000008080000ULL, 0x0008000208080000ULL,
        0x0008000000000800ULL, 0x0008000200000800ULL, 0x0008000008000800ULL, 0x0008000208000800ULL,
        0x0008000000080800ULL, 0x0008000200080800ULL, 0x0008000008080800ULL, 0x0008000208080800ULL,
        0x0008000000000008ULL, 0x0008000200000008ULL, 0x0008000008000008ULL, 0x0008000208000008ULL,
        0x0008000000080008ULL, 0x0008000200080008ULL, 0x0008000008080008ULL, 0x0008000208080008ULL,
        0x0008000000000808ULL, 0x0008000200000808ULL, 0x0008000008000808ULL, 0x0008000208000808ULL,
        0x0008000000080808ULL, 0x0008000200080808ULL, 0x0008000008080808ULL, 0x0008000208080808ULL,
        0x0808000000000000ULL, 0x0808000200000000ULL, 0x0808000008000000ULL, 0x0808000208000000ULL,
        0x0808000000080000ULL, 0x0808000200080000ULL, 0x0808000008080000ULL, 0x0808000208080000ULL,
        0x0808000000000800ULL, 0x0808000200000800ULL, 0x0808000008000800ULL, 0x0808000208000800ULL,
        0x0808000000080800ULL, 0x0808000200080800ULL, 0x0808000008080800ULL, 0x0808000208080800ULL,
        0x0808000000000008ULL, 0x0808000200000008ULL, 0x0808000008000008ULL, 0x0808000208000008ULL,
        0x0808000000080008ULL, 0x0808000200080008ULL, 0x0808000008080008ULL, 0x0808000208080008ULL,
        0x0808000000000808ULL, 0x0808000200000808ULL, 0x0808000008000808ULL, 0x0808000208000808ULL,
        0x0808000000080808ULL, 0x0808000200080808ULL, 0x0808000008080808ULL, 0x0808000208080808ULL,
        0x0000080000000000ULL, 0x0000080200000000ULL, 0x0000080008000000ULL, 0x0000080208000000ULL,
        0x0000080000080000ULL, 0x0000080200080000ULL, 0x0000080008080000ULL, 0x0000080208080000ULL,
        0x0000080000000800ULL, 0x0000080200000800ULL, 0x0000080008000800ULL, 0x0000080208000800ULL,
        0x0000080000080800ULL, 0x0000080200080800ULL, 0x0000080008080800ULL, 0x0000080208080800ULL,
        0x0000080000000008ULL, 0x0000080200000008ULL, 0x0000080008000008ULL, 0x0000080208000008ULL,
        0x0000080000080008ULL, 0x0000080200080008ULL, 0x0000080008080008ULL, 0x0000080208080008ULL,
        0x0000080000000808ULL, 0x0000080200000808ULL, 0x0000080008000808ULL, 0x0000080208000808ULL,
        0x0000080000080808ULL, 0x0000080200080808ULL, 0x0000080008080808ULL, 0x0000080208080808ULL,
        0x0800080000000000ULL, 0x0800080200000000ULL, 0x0800080008000000ULL, 0x0800080208000000ULL,
        0x0800080000080000ULL, 0x0800080200080000ULL, 0x0800080008080000ULL, 0x0800080208080000ULL,
        0x0800080000000800ULL, 0x0800080200000800ULL, 0x0800080008000800ULL, 0x0800080208000800ULL,
        0x0800080000080800ULL, 0x0800080200080800ULL, 0x0800080008080800ULL, 0x0800080208080800ULL,
        0x0800080000000008ULL, 0x0800080200000008ULL, 0x0800080008000008ULL, 0x0800080208000008ULL,
        0x0800080000080008ULL, 0x0800080200080008ULL, 0x0800080008080008ULL, 0x0800080208080008ULL,
        0x0800080000000808ULL, 0x0800080200000808ULL, 0x0800080008000808ULL, 0x0800080208000808ULL,
        0x0800080000080808ULL, 0x0800080200080808ULL, 0x0800080008080808ULL, 0x0800080208080808ULL,
        0x0008080000000000ULL, 0x0008080200000000ULL, 0x0008080008000000ULL, 0x0008080208000000ULL,
        0x0008080000080000ULL, 0x0008080200080000ULL, 0x0008080008080000ULL, 0x0008080208080000ULL,
        0x0008080000000800ULL, 0x0008080200000800ULL, 0x0008080008000800ULL, 0x0008080208000800ULL,
        0x0008080000080800ULL, 0x0008080200080800ULL, 0x0008080008080800ULL, 0x0008080208080800ULL,
        0x0008080000000008ULL, 0x0008080200000008ULL, 0x0008080008000008ULL, 0x0008080208000008ULL,
        0x0008080000080008ULL, 0x0008080200080008ULL, 0x0008080008080008ULL, 0x0008080208080008ULL,
        0x0008080000000808ULL, 0x0008080200000808ULL, 0x0008080008000808ULL, 0x0008080208000808ULL,
        0x0008080000080808ULL, 0x0008080200080808ULL, 0x0008080008080808ULL, 0x0008080208080808ULL,
        0x0808080000000000ULL, 0x0808080200000000ULL, 0x0808080008000000ULL, 0x0808080208000000ULL,
        0x0808080000080000ULL, 0x0808080200080000ULL, 0x0808080008080000ULL, 0x0808080208080000ULL,
        0x0808080000000800ULL, 0x0808080200000800ULL, 0x0808080008000800ULL, 0x0808080208000800ULL,
        0x0808080000080800ULL, 0x0808080200080800ULL, 0x0808080008080800ULL, 0x0808080208080800ULL,
        0x0808080000000008ULL, 0x0808080200000008ULL, 0x0808080008000008ULL, 0x0808080208000008ULL,
        0x0808080000080008ULL, 0x0808080200080008ULL, 0x0808080008080008ULL, 0x0808080208080008ULL,
        0x0808080000000808ULL, 0x0808080200000808ULL, 0x0808080008000808ULL, 0x0808080208000808ULL,
        0x0808080000080808ULL, 0x0808080200080808ULL, 0x0808080008080808ULL, 0x0808080208080808ULL
    },
    {
        0x0000000000000000ULL, 0x0000000800000000ULL, 0x0000000020000000ULL, 0x0000000820000000ULL,
        0x0000000000200000ULL, 0x0000000800200000ULL, 0x0000000020200000ULL, 0x0000000820200000ULL,
        0x0000000000002000ULL, 0x0000000800002000ULL, 0x0000000020002000ULL, 0x0000000820002000ULL,
        0x0000000000202000ULL, 0x0000000800202000ULL, 0x0000000020202000ULL, 0x0000000820202000ULL,
        0x0000000000000020ULL, 0x0000000800000020ULL, 0x0000000020000020ULL, 0x0000000820000020ULL,
        0x0000000000200020ULL, 0x0000000800200020ULL, 0x0000000020200020ULL, 0x0000000820200020ULL,
        0x0000000000002020ULL, 0x0000000800002020ULL, 0x0000000020002020ULL, 0x0000000820002020ULL,
        0x0000000000202020ULL, 0x0000000800202020ULL, 0x0000000020202020ULL, 0x0000000820202020ULL,
        0x2000000000000000ULL, 0x2000000800000000ULL, 0x2000000020000000ULL, 0x2000000820000000ULL,
        0x2000000000200000ULL, 0x2000000800200000ULL, 0x2000000020200000ULL, 0x2000000820200000ULL,
        0x2000000000002000ULL, 0x2000000800002000ULL, 0x2000000020002000ULL, 0x2000000820002000ULL,
        0x2000000000202000ULL, 0x2000000800202000ULL, 0x2000000020202000ULL, 0x2000000820202000ULL,
        0x2000000000000020ULL, 0x2000000800000020ULL, 0x2000000020000020ULL, 0x2000000820000020ULL,
        0x2000000000200020ULL, 0x2000000800200020ULL, 0x2000000020200020ULL, 0x2000000820200020ULL,
        0x2000000000002020ULL, 0x2000000800002020ULL, 0x2000000020002020ULL, 0x2000000820002020ULL,
        0x2000000000202020ULL, 0x2000000800202020ULL, 0x2000000020202020ULL, 0x2000000820202020ULL,
        0x0020000000000000ULL, 0x0020000800000000ULL, 0x0020000020000000ULL, 0x0020000820000000ULL,
        0x0020000000200000ULL, 0x0020000800200000ULL, 0x0020000020200000ULL, 0x0020000820200000ULL,
        0x0020000000002000ULL, 0x0020000800002000ULL, 0x0020000020002000ULL, 0x0020000820002000ULL,
        0x0020000000202000ULL, 0x0020000800202000ULL, 0x0020000020202000ULL, 0x0020000820202000ULL,
        0x0020000000000020ULL, 0x0020000800000020ULL, 0x0020000020000020ULL, 0x0020000820000020ULL,
        0x0020000000200020ULL, 0x0020000800200020ULL, 0x0020000020200020ULL, 0x0020000820200020ULL,
        0x0020000000002020ULL, 0x0020000800002020ULL, 0x0020000020002020ULL, 0x0020000820002020ULL,
        0x0020000000202020ULL, 0x0020000800202020ULL, 0x0020000020202020ULL, 0x0020000820202020ULL,
        0x2020000000000000ULL, 0x2020000800000000ULL, 0x2020000020000000ULL, 0x2020000820000000ULL,
        0x2020000000200000ULL, 0x2020000800200000ULL, 0x2020000020200000ULL, 0x2020000820200000ULL,
        0x2020000000002000ULL, 0x2020000800002000ULL, 0x2020000020002000ULL, 0x2020000820002000ULL,
        0x2020000000202000ULL, 0x2020000800202000ULL, 0x2020000020202000ULL, 0x2020000820202000ULL,
        0x2020000000000020ULL, 0x2020000800000020ULL, 0x2020000020000020ULL, 0x2020000820000020ULL,
        0x2020000000200020ULL, 0x2020000800200020ULL, 0x2020000020200020ULL, 0x2020000820200020ULL,
        0x2020000000002020ULL, 0x2020000800002020ULL, 0x2020000020002020ULL, 0x2020000820002020ULL,
        0x2020000000202020ULL, 0x2020000800202020ULL, 0x2020000020202020ULL, 0x2020000820202020ULL,
        0x0000200000000000ULL, 0x0000200800000000ULL, 0x0000200020000000ULL, 0x0000200820000000ULL,
        0x0000200000200000ULL, 0x0000200800200000ULL, 0x0000200020200000ULL, 0x0000200820200000ULL,
        0x0000200000002000ULL, 0x0000200800002000ULL, 0x0000200020002000ULL, 0x0000200820002000ULL,
        0x0000200000202000ULL, 0x0000200800202000ULL, 0x0000200020202000ULL, 0x0000200820202000ULL,
        0x0000200000000020ULL, 0x0000200800000020ULL, 0x0000200020000020ULL, 0x0000200820000020ULL,
        0x0000200000200020ULL, 0x0000200800200020ULL, 0x0000200020200020ULL, 0x0000200820200020ULL,
        0x0000200000002020ULL, 0x0000200800002020ULL, 0x0000200020002020ULL, 0x0000200820002020ULL,
        0x0000200000202020ULL, 0x0000200800202020ULL, 0x0000200020202020ULL, 0x0000200820202020ULL,
        0x2000200000000000ULL, 0x2000200800000000ULL, 0x2000200020000000ULL, 0x2000200820000000ULL,
        0x2000200000200000ULL, 0x2000200800200000ULL, 0x2000200020200000ULL, 0x2000200820200000ULL,
        0x2000200000002000ULL, 0x2000200800002000ULL, 0x2000200020002000ULL, 0x2000200820002000ULL,
        0x2000200000202000ULL, 0x2000200800202000ULL, 0x2000200020202000ULL, 0x2000200820202000ULL,
        0x2000200000000020ULL, 0x2000200800000020ULL, 0x2000200020000020ULL, 0x2000200820000020ULL,
        0x2000200000200020ULL, 0x2000200800200020ULL, 0x2000200020200020ULL, 0x2000200820200020ULL,
        0x2000200000002020ULL, 0x2000200800002020ULL, 0x2000200020002020ULL, 0x2000200820002020ULL,
        0x2000200000202020ULL, 0x2000200800202020ULL, 0x2000200020202020ULL, 0x2000200820202020ULL,
        0x0020200000000000ULL, 0x0020200800000000ULL, 0x0020200020000000ULL, 0x0020200820000000ULL,
        0x0020200000200000ULL, 0x0020200800200000ULL, 0x0020200020200000ULL, 0x0020200820200000ULL,
        0x0020200000002000ULL, 0x0020200800002000ULL, 0x0020200020002000ULL, 0x0020200820002000ULL,
        0x0020200000202000ULL, 0x0020200800202000ULL, 0x0020200020202000ULL, 0x0020200820202000ULL,
        0x0020200000000020ULL, 0x0020200800000020ULL, 0x0020200020000020ULL, 0x0020200820000020ULL,
        0x0020200000200020ULL, 0x0020200800200020ULL, 0x0020200020200020ULL, 0x0020200820200020ULL,
        0x0020200000002020ULL, 0x0020200800002020ULL, 0x0020200020002020ULL, 0x0020200820002020ULL,
        0x0020200000202020ULL, 0x0020200800202020ULL, 0x0020200020202020ULL, 0x0020200820202020ULL,
        0x2020200000000000ULL, 0x2020200800000000ULL, 0x2020200020000000ULL, 0x2020200820000000ULL,
        0x2020200000200000ULL, 0x2020200800200000ULL, 0x2020200020200000ULL, 0x2020200820200000ULL,
        0x2020200000002000ULL, 0x2020200800002000ULL, 0x2020200020002000ULL, 0x2020200820002000ULL,
        0x2020200000202000ULL, 0x2020200800202000ULL, 0x2020200020202000ULL, 0x2020200820202000ULL,
        0x2020200000000020ULL, 0x2020200800000020ULL, 0x2020200020000020ULL, 0x2020200820000020ULL,
        0x2020200000200020ULL, 0x2020200800200020ULL, 0x2020200020200020ULL, 0x2020200820200020ULL,
        0x2020200000002020ULL, 0x2020200800002020ULL, 0x2020200020002020ULL, 0x2020200820002020ULL,
        0x2020200000202020ULL, 0x2020200800202020ULL, 0x2020200020202020ULL, 0x2020200820202020ULL
    },
    {
        0x0000000000000000ULL, 0x0000002000000000ULL, 0x0000000080000000ULL, 0x0000002080000000ULL,
        0x0000000000800000ULL, 0x0000002000800000ULL, 0x0000000080800000ULL, 0x0000002080800000ULL,
        0x0000000000008000ULL, 0x0000002000008000ULL, 0x0000000080008000ULL, 0x0000002080008000ULL,
        0x0000000000808000ULL, 0x0000002000808000ULL, 0x0000000080808000ULL, 0x0000002080808000ULL,
        0x0000000000000080ULL, 0x0000002000000080ULL, 0x0000000080000080ULL, 0x0000002080000080ULL,
        0x0000000000800080ULL, 0x0000002000800080ULL, 0x0000000080800080ULL, 0x0000002080800080ULL,
        0x0000000000008080ULL, 0x0000002000008080ULL, 0x0000000080008080ULL, 0x0000002080008080ULL,
        0x0000000000808080ULL, 0x0000002000808080ULL, 0x0000000080808080ULL, 0x0000002080808080ULL,
        0x8000000000000000ULL, 0x8000002000000000ULL, 0x8000000080000000ULL, 0x8000002080000000ULL,
        0x8000000000800000ULL, 0x8000002000800000ULL, 0x8000000080800000ULL, 0x8000002080800000ULL,
        0x8000000000008000ULL, 0x8000002000008000ULL, 0x8000000080008000ULL, 0x8000002080008000ULL,
        0x8000000000808000ULL, 0x8000002000808000ULL, 0x8000000080808000ULL, 0x8000002080808000ULL,
        0x8000000000000080ULL, 0x8000002000000080ULL, 0x8000000080000080ULL, 0x8000002080000080ULL,
        0x8000000000800080ULL, 0x8000002000800080ULL, 0x8000000080800080ULL, 0x8000002080800080ULL,
        0x8000000000008080ULL, 0x8000002000008080ULL, 0x8000000080008080ULL, 0x8000002080008080ULL,
        0x8000000000808080ULL, 0x8000002000808080ULL, 0x8000000080808080ULL, 0x8000002080808080ULL,
        0x0080000000000000ULL, 0x0080002000000000ULL, 0x0080000080000000ULL, 0x0080002080000000ULL,
        0x0080000000800000ULL, 0x0080002000800000ULL, 0x0080000080800000ULL, 0x0080002080800000ULL,
        0x0080000000008000ULL, 0x0080002000008000ULL, 0x0080000080008000ULL, 0x0080002080008000ULL,
        0x0080000000808000ULL, 0x0080002000808000ULL, 0x0080000080808000ULL, 0x0080002080808000ULL,
        0x0080000000000080ULL, 0x0080002000000080ULL, 0x0080000080000080ULL, 0x0080002080000080ULL,
        0x0080000000800080ULL, 0x0080002000800080ULL, 0x0080000080800080ULL, 0x0080002080800080ULL,
        0x0080000000008080ULL, 0x0080002000008080ULL, 0x0080000080008080ULL, 0x0080002080008080ULL,
        0x0080000000808080ULL, 0x0080002000808080ULL, 0x0080000080808080ULL, 0x0080002080808080ULL,
        0x8080000000000000ULL, 0x8080002000000000ULL, 0x8080000080000000ULL, 0x8080002080000000ULL,
        0x8080000000800000ULL, 0x8080002000800000ULL, 0x8080000080800000ULL, 0x8080002080800000ULL,
        0x8080000000008000ULL, 0x8080002000008000ULL, 0x8080000080008000ULL, 0x8080002080008000ULL,
        0x8080000000808000ULL, 0x8080002000808000ULL, 0x8080000080808000ULL, 0x8080002080808000ULL,
        0x8080000000000080ULL, 0x8080002000000080ULL, 0x8080000080000080ULL, 0x8080002080000080ULL,
        0x8080000000800080ULL, 0x8080002000800080ULL, 0x8080000080800080ULL, 0x8080002080800080ULL,
        0x8080000000008080ULL, 0x8080002000008080ULL, 0x8080000080008080ULL, 0x8080002080008080ULL,
        0x8080000000808080ULL, 0x8080002000808080ULL, 0x8080000080808080ULL, 0x8080002080808080ULL,
        0x0000800000000000ULL, 0x0000802000000000ULL, 0x0000800080000000ULL, 0x0000802080000000ULL,
        0x0000800000800000ULL, 0x0000802000800000ULL, 0x0000800080800000ULL, 0x0000802080800000ULL,
        0x0000800000008000ULL, 0x0000802000008000ULL, 0x0000800080008000ULL, 0x0000802080008000ULL,
        0x0000800000808000ULL, 0x0000802000808000ULL, 0x0000800080808000ULL, 0x0000802080808000ULL,
        0x0000800000000080ULL, 0x0000802000000080ULL, 0x0000800080000080ULL, 0x0000802080000080ULL,
        0x0000800000800080ULL, 0x0000802000800080ULL, 0x0000800080800080ULL, 0x0000802080800080ULL,
        0x0000800000008080ULL, 0x0000802000008080ULL, 0x0000800080008080ULL, 0x0000802080008080ULL,
        0x0000800000808080ULL, 0x0000802000808080ULL, 0x0000800080808080ULL, 0x0000802080808080ULL,
        0x8000800000000000ULL, 0x8000802000000000ULL, 0x8000800080000000ULL, 0x8000802080000000ULL,
        0x8000800000800000ULL, 0x8000802000800000ULL, 0x8000800080800000ULL, 0x8000802080800000ULL,
        0x8000800000008000ULL, 0x8000802000008000ULL, 0x8000800080008000ULL, 0x8000802080008000ULL,
        0x8000800000808000ULL, 0x8000802000808000ULL, 0x8000800080808000ULL, 0x8000802080808000ULL,
        0x8000800000000080ULL, 0x8000802000000080ULL, 0x8000800080000080ULL, 0x8000802080000080ULL,
        0x8000800000800080ULL, 0x8000802000800080ULL, 0x8000800080800080ULL, 0x8000802080800080ULL,
        0x8000800000008080ULL, 0x8000802000008080ULL, 0x8000800080008080ULL, 0x8000802080008080ULL,
        0x8000800000808080ULL, 0x8000802000808080ULL, 0x8000800080808080ULL, 0x8000802080808080ULL,
        0x0080800000000000ULL, 0x0080802000000000ULL, 0x0080800080000000ULL, 0x0080802080000000ULL,
        0x0080800000800000ULL, 0x0080802000800000ULL, 0x0080800080800000ULL, 0x0080802080800000ULL,
        0x0080800000008000ULL, 0x0080802000008000ULL, 0x0080800080008000ULL, 0x0080802080008000ULL,
        0x0080800000808000ULL, 0x0080802000808000ULL, 0x0080800080808000ULL, 0x0080802080808000ULL,
        0x0080800000000080ULL, 0x0080802000000080ULL, 0x0080800080000080ULL, 0x0080802080000080ULL,
        0x0080800000800080ULL, 0x0080802000800080ULL, 0x0080800080800080ULL, 0x0080802080800080ULL,
        0x0080800000008080ULL, 0x0080802000008080ULL, 0x0080800080008080ULL, 0x0080802080008080ULL,
        0x0080800000808080ULL, 0x0080802000808080ULL, 0x0080800080808080ULL, 0x0080802080808080ULL,
        0x8080800000000000ULL, 0x8080802000000000ULL, 0x8080800080000000ULL, 0x8080802080000000ULL,
        0x8080800000800000ULL, 0x8080802000800000ULL, 0x8080800080800000ULL, 0x8080802080800000ULL,
        0x8080800000008000ULL, 0x8080802000008000ULL, 0x8080800080008000ULL, 0x8080802080008000ULL,
        0x8080800000808000ULL, 0x8080802000808000ULL, 0x8080800080808000ULL, 0x8080802080808000ULL,
        0x8080800000000080ULL, 0x8080802000000080ULL, 0x8080800080000080ULL, 0x8080802080000080ULL,
        0x8080800000800080ULL, 0x8080802000800080ULL, 0x8080800080800080ULL, 0x8080802080800080ULL,
        0x8080800000008080ULL, 0x8080802000008080ULL, 0x8080800080008080ULL, 0x8080802080008080ULL,
        0x8080800000808080ULL, 0x8080802000808080ULL, 0x8080800080808080ULL, 0x8080802080808080ULL
    },
    {
        0x0000000000000000ULL, 0x0000004000000000ULL, 0x0000000001000000ULL, 0x0000004001000000ULL,
        0x0000000000010000ULL, 0x0000004000010000ULL, 0x0000000001010000ULL, 0x0000004001010000ULL,
        0x0000000000000100ULL, 0x0000004000000100ULL, 0x0000000001000100ULL, 0x0000004001000100ULL,
        0x0000000000010100ULL, 0x0000004000010100ULL, 0x0000000001010100ULL, 0x0000004001010100ULL,
        0x0000000000000001ULL, 0x0000004000000001ULL, 0x0000000001000001ULL, 0x0000004001000001ULL,
        0x0000000000010001ULL, 0x0000004000010001ULL, 0x0000000001010001ULL, 0x0000004001010001ULL,
        0x0000000000000101ULL, 0x0000004000000101ULL, 0x0000000001000101ULL, 0x0000004001000101ULL,
        0x0000000000010101ULL, 0x0000004000010101ULL, 0x0000000001010101ULL, 0x0000004001010101ULL,
        0x0100000000000000ULL, 0x0100004000000000ULL, 0x0100000001000000ULL, 0x0100004001000000ULL,
        0x0100000000010000ULL, 0x0100004000010000ULL, 0x0100000001010000ULL, 0x0100004001010000ULL,
        0x0100000000000100ULL, 0x0100004000000100ULL, 0x0100000001000100ULL, 0x0100004001000100ULL,
        0x0100000000010100ULL, 0x0100004000010100ULL, 0x0100000001010100ULL, 0x0100004001010100ULL,
        0x0100000000000001ULL, 0x0100004000000001ULL, 0x0100000001000001ULL, 0x0100004001000001ULL,
        0x0100000000010001ULL, 0x0100004000010001ULL, 0x0100000001010001ULL, 0x0100004001010001ULL,
        0x0100000000000101ULL, 0x0100004000000101ULL, 0x0100000001000101ULL, 0x0100004001000101ULL,
        0x0100000000010101ULL, 0x0100004000010101ULL, 0x0100000001010101ULL, 0x0100004001010101ULL,
        0x0001000000000000ULL, 0x0001004000000000ULL, 0x0001000001000000ULL, 0x0001004001000000ULL,
        0x0001000000010000ULL, 0x0001004000010000ULL, 0x0001000001010000ULL, 0x0001004001010000ULL,
        0x0001000000000100ULL, 0x0001004000000100ULL, 0x0001000001000100ULL, 0x0001004001000100ULL,
        0x0001000000010100ULL, 0x0001004000010100ULL, 0x0001000001010100ULL, 0x0001004001010100ULL,
        0x0001000000000001ULL, 0x0001004000000001ULL, 0x0001000001000001ULL, 0x0001004001000001ULL,
        0x0001000000010001ULL, 0x0001004000010001ULL, 0x0001000001010001ULL, 0x0001004001010001ULL,
        0x0001000000000101ULL, 0x0001004000000101ULL, 0x0001000001000101ULL, 0x0001004001000101ULL,
        0x0001000000010101ULL, 0x0001004000010101ULL, 0x0001000001010101ULL, 0x0001004001010101ULL,
        0x0101000000000000ULL, 0x0101004000000000ULL, 0x0101000001000000ULL, 0x0101004001000000ULL,
        0x0101000000010000ULL, 0x0101004000010000ULL, 0x0101000001010000ULL, 0x0101004001010000ULL,
        0x0101000000000100ULL, 0x0101004000000100ULL, 0x0101000001000100ULL, 0x0101004001000100ULL,
        0x0101000000010100ULL, 0x0101004000010100ULL, 0x0101000001010100ULL, 0x0101004001010100ULL,
        0x0101000000000001ULL, 0x0101004000000001ULL, 0x0101000001000001ULL, 0x0101004001000001ULL,
        0x0101000000010001ULL, 0x0101004000010001ULL, 0x0101000001010001ULL, 0x0101004001010001ULL,
        0x0101000000000101ULL, 0x0101004000000101ULL, 0x0101000001000101ULL, 0x0101004001000101ULL,
        0x0101000000010101ULL, 0x0101004000010101ULL, 0x0101000001010101ULL, 0x0101004001010101ULL,
        0x0000010000000000ULL, 0x0000014000000000ULL, 0x0000010001000000ULL, 0x0000014001000000ULL,
        0x0000010000010000ULL, 0x0000014000010000ULL, 0x0000010001010000ULL, 0x0000014001010000ULL,
        0x0000010000000100ULL, 0x0000014000000100ULL, 0x0000010001000100ULL, 0x0000014001000100ULL,
        0x0000010000010100ULL, 0x0000014000010100ULL, 0x0000010001010100ULL, 0x0000014001010100ULL,
        0x0000010000000001ULL, 0x0000014000000001ULL, 0x0000010001000001ULL, 0x0000014001000001ULL,
        0x0000010000010001ULL, 0x0000014000010001ULL, 0x0000010001010001ULL, 0x0000014001010001ULL,
        0x0000010000000101ULL, 0x0000014000000101ULL, 0x0000010001000101ULL, 0x0000014001000101ULL,
        0x0000010000010101ULL, 0x0000014000010101ULL, 0x0000010001010101ULL, 0x0000014001010101ULL,
        0x0100010000000000ULL, 0x0100014000000000ULL, 0x0100010001000000ULL, 0x0100014001000000ULL,
        0x0100010000010000ULL, 0x0100014000010000ULL, 0x0100010001010000ULL, 0x0100014001010000ULL,
        0x0100010000000100ULL, 0x0100014000000100ULL, 0x0100010001000100ULL, 0x0100014001000100ULL,
        0x0100010000010100ULL, 0x0100014000010100ULL, 0x0100010001010100ULL, 0x0100014001010100ULL,
        0x0100010000000001ULL, 0x0100014000000001ULL, 0x0100010001000001ULL, 0x0100014001000001ULL,
        0x0100010000010001ULL, 0x0100014000010001ULL, 0x0100010001010001ULL, 0x0100014001010001ULL,
        0x0100010000000101ULL, 0x0100014000000101ULL, 0x0100010001000101ULL, 0x0100014001000101ULL,
        0x0100010000010101ULL, 0x0100014000010101ULL, 0x0100010001010101ULL, 0x0100014001010101ULL,
        0x0001010000000000ULL, 0x0001014000000000ULL, 0x0001010001000000ULL, 0x0001014001000000ULL,
        0x0001010000010000ULL, 0x0001014000010000ULL, 0x0001010001010000ULL, 0x0001014001010000ULL,
        0x0001010000000100ULL, 0x0001014000000100ULL, 0x0001010001000100ULL, 0x0001014001000100ULL,
        0x0001010000010100ULL, 0x0001014000010100ULL, 0x0001010001010100ULL, 0x0001014001010100ULL,
        0x0001010000000001ULL, 0x0001014000000001ULL, 0x0001010001000001ULL, 0x0001014001000001ULL,
        0x0001010000010001ULL, 0x0001014000010001ULL, 0x0001010001010001ULL, 0x0001014001010001ULL,
        0x0001010000000101ULL, 0x0001014000000101ULL, 0x0001010001000101ULL, 0x0001014001000101ULL,
        0x0001010000010101ULL, 0x0001014000010101ULL, 0x0001010001010101ULL, 0x0001014001010101ULL,
        0x0101010000000000ULL, 0x0101014000000000ULL, 0x0101010001000000ULL, 0x0101014001000000ULL,
        0x0101010000010000ULL, 0x0101014000010000ULL, 0x0101010001010000ULL, 0x0101014001010000ULL,
        0x0101010000000100ULL, 0x0101014000000100ULL, 0x0101010001000100ULL, 0x0101014001000100ULL,
        0x0101010000010100ULL, 0x0101014000010100ULL, 0x0101010001010100ULL, 0x0101014001010100ULL,
        0x0101010000000001ULL, 0x0101014000000001ULL, 0x0101010001000001ULL, 0x0101014001000001ULL,
        0x0101010000010001ULL, 0x0101014000010001ULL, 0x0101010001010001ULL, 0x0101014001010001ULL,
        0x0101010000000101ULL, 0x0101014000000101ULL, 0x0101010001000101ULL, 0x0101014001000101ULL,
        0x0101010000010101ULL, 0x0101014000010101ULL, 0x0101010001010101ULL, 0x0101014001010101ULL
    },
    {
        0x0000000000000000ULL, 0x0000000100000000ULL, 0x0000000004000000ULL, 0x0000000104000000ULL,
        0x0000000000040000ULL, 0x0000000100040000ULL, 0x0000000004040000ULL, 0x0000000104040000ULL,
        0x0000000000000400ULL, 0x0000000100000400ULL, 0x0000000004000400ULL, 0x0000000104000400ULL,
        0x0000000000040400ULL, 0x0000000100040400ULL, 0x0000000004040400ULL, 0x0000000104040400ULL,
        0x0000000000000004ULL, 0x0000000100000004ULL, 0x0000000004000004ULL, 0x0000000104000004ULL,
        0x0000000000040004ULL, 0x0000000100040004ULL, 0x0000000004040004ULL, 0x0000000104040004ULL,
        0x0000000000000404ULL, 0x0000000100000404ULL, 0x0000000004000404ULL, 0x0000000104000404ULL,
        0x0000000000040404ULL, 0x0000000100040404ULL, 0x0000000004040404ULL, 0x0000000104040404ULL,
        0x0400000000000000ULL, 0x0400000100000000ULL, 0x0400000004000000ULL, 0x0400000104000000ULL,
        0x0400000000040000ULL, 0x0400000100040000ULL, 0x0400000004040000ULL, 0x0400000104040000ULL,
        0x0400000000000400ULL, 0x0400000100000400ULL, 0x0400000004000400ULL, 0x0400000104000400ULL,
        0x0400000000040400ULL, 0x0400000100040400ULL, 0x0400000004040400ULL, 0x0400000104040400ULL,
        0x0400000000000004ULL, 0x0400000100000004ULL, 0x0400000004000004ULL, 0x0400000104000004ULL,
        0x0400000000040004ULL, 0x0400000100040004ULL, 0x0400000004040004ULL, 0x0400000104040004ULL,
        0x0400000000000404ULL, 0x0400000100000404ULL, 0x0400000004000404ULL, 0x0400000104000404ULL,
        0x0400000000040404ULL, 0x0400000100040404ULL, 0x0400000004040404ULL, 0x0400000104040404ULL,
        0x0004000000000000ULL, 0x0004000100000000ULL, 0x0004000004000000ULL, 0x0004000104000000ULL,
        0x0004000000040000ULL, 0x0004000100040000ULL, 0x0004000004040000ULL, 0x0004000104040000ULL,
        0x0004000000000400ULL, 0x0004000100000400ULL, 0x0004000004000400ULL, 0x0004000104000400ULL,
        0x0004000000040400ULL, 0x0004000100040400ULL, 0x0004000004040400ULL, 0x0004000104040400ULL,
        0x0004000000000004ULL, 0x0004000100000004ULL, 0x0004000004000004ULL, 0x0004000104000004ULL,
        0x0004000000040004ULL, 0x0004000100040004ULL, 0x0004000004040004ULL, 0x0004000104040004ULL,
        0x0004000000000404ULL, 0x0004000100000404ULL, 0x0004000004000404ULL, 0x0004000104000404ULL,
        0x0004000000040404ULL, 0x0004000100040404ULL, 0x0004000004040404ULL, 0x0004000104040404ULL,
        0x0404000000000000ULL, 0x0404000100000000ULL, 0x0404000004000000ULL, 0x0404000104000000ULL,
        0x0404000000040000ULL, 0x0404000100040000ULL, 0x0404000004040000ULL, 0x0404000104040000ULL,
        0x0404000000000400ULL, 0x0404000100000400ULL, 0x0404000004000400ULL, 0x0404000104000400ULL,
        0x0404000000040400ULL, 0x0404000100040400ULL, 0x0404000004040400ULL, 0x0404000104040400ULL,
        0x0404000000000004ULL, 0x0404000100000004ULL, 0x0404000004000004ULL, 0x0404000104000004ULL,
        0x0404000000040004ULL, 0x0404000100040004ULL, 0x0404000004040004ULL, 0x0404000104040004ULL,
        0x0404000000000404ULL, 0x0404000100000404ULL, 0x0404000004000404ULL, 0x0404000104000404ULL,
        0x0404000000040404ULL, 0x0404000100040404ULL, 0x0404000004040404ULL, 0x0404000104040404ULL,
        0x0000040000000000ULL, 0x0000040100000000ULL, 0x0000040004000000ULL, 0x0000040104000000ULL,
        0x0000040000040000ULL, 0x0000040100040000ULL, 0x0000040004040000ULL, 0x0000040104040000ULL,
        0x0000040000000400ULL, 0x0000040100000400ULL, 0x0000040004000400ULL, 0x0000040104000400ULL,
        0x0000040000040400ULL, 0x0000040100040400ULL, 0x0000040004040400ULL, 0x0000040104040400ULL,
        0x0000040000000004ULL, 0x0000040100000004ULL, 0x0000040004000004ULL, 0x0000040104000004ULL,
        0x0000040000040004ULL, 0x0000040100040004ULL, 0x0000040004040004ULL, 0x0000040104040004ULL,
        0x0000040000000404ULL, 0x0000040100000404ULL, 0x0000040004000404ULL, 0x0000040104000404ULL,
        0x0000040000040404ULL, 0x0000040100040404ULL, 0x0000040004040404ULL, 0x0000040104040404ULL,
        0x0400040000000000ULL, 0x0400040100000000ULL, 0x0400040004000000ULL, 0x0400040104000000ULL,
        0x0400040000040000ULL, 0x0400040100040000ULL, 0x0400040004040000ULL, 0x0400040104040000ULL,
        0x0400040000000400ULL, 0x0400040100000400ULL, 0x0400040004000400ULL, 0x0400040104000400ULL,
        0x0400040000040400ULL, 0x0400040100040400ULL, 0x0400040004040400ULL, 0x0400040104040400ULL,
        0x0400040000000004ULL, 0x0400040100000004ULL, 0x0400040004000004ULL, 0x0400040104000004ULL,
        0x0400040000040004ULL, 0x0400040100040004ULL, 0x0400040004040004ULL, 0x0400040104040004ULL,
        0x0400040000000404ULL, 0x0400040100000404ULL, 0x0400040004000404ULL, 0x0400040104000404ULL,
        0x0400040000040404ULL, 0x0400040100040404ULL, 0x0400040004040404ULL, 0x0400040104040404ULL,
        0x0004040000000000ULL, 0x0004040100000000ULL, 0x0004040004000000ULL, 0x0004040104000000ULL,
        0x0004040000040000ULL, 0x0004040100040000ULL, 0x0004040004040000ULL, 0x0004040104040000ULL,
        0x0004040000000400ULL, 0x0004040100000400ULL, 0x0004040004000400ULL, 0x0004040104000400ULL,
        0x0004040000040400ULL, 0x0004040100040400ULL, 0x0004040004040400ULL, 0x0004040104040400ULL,
        0x0004040000000004ULL, 0x0004040100000004ULL, 0x0004040004000004ULL, 0x0004040104000004ULL,
        0x0004040000040004ULL, 0x0004040100040004ULL, 0x0004040004040004ULL, 0x0004040104040004ULL,
        0x0004040000000404ULL, 0x0004040100000404ULL, 0x0004040004000404ULL, 0x0004040104000404ULL,
        0x0004040000040404ULL, 0x0004040100040404ULL, 0x0004040004040404ULL, 0x0004040104040404ULL,
        0x0404040000000000ULL, 0x0404040100000000ULL, 0x0404040004000000ULL, 0x0404040104000000ULL,
        0x0404040000040000ULL, 0x0404040100040000ULL, 0x0404040004040000ULL, 0x0404040104040000ULL,
        0x0404040000000400ULL, 0x0404040100000400ULL, 0x0404040004000400ULL, 0x0404040104000400ULL,
        0x0404040000040400ULL, 0x0404040100040400ULL, 0x0404040004040400ULL, 0x0404040104040400ULL,
        0x0404040000000004ULL, 0x0404040100000004ULL, 0x0404040004000004ULL, 0x0404040104000004ULL,
        0x0404040000040004ULL, 0x0404040100040004ULL, 0x0404040004040004ULL, 0x0404040104040004ULL,
        0x0404040000000404ULL, 0x0404040100000404ULL, 0x0404040004000404ULL, 0x0404040104000404ULL,
        0x0404040000040404ULL, 0x0404040100040404ULL, 0x0404040004040404ULL, 0x0404040104040404ULL
    },
    {
        0x0000000000000000ULL, 0x0000000400000000ULL, 0x0000000010000000ULL, 0x0000000410000000ULL,
        0x0000000000100000ULL, 0x0000000400100000ULL, 0x0000000010100000ULL, 0x0000000410100000ULL,
        0x0000000000001000ULL, 0x0000000400001000ULL, 0x0000000010001000ULL, 0x0000000410001000ULL,
        0x0000000000101000ULL, 0x0000000400101000ULL, 0x0000000010101000ULL, 0x0000000410101000ULL,
        0x0000000000000010ULL, 0x0000000400000010ULL, 0x0000000010000010ULL, 0x0000000410000010ULL,
        0x0000000000100010ULL, 0x0000000400100010ULL, 0x0000000010100010ULL, 0x0000000410100010ULL,
        0x0000000000001010ULL, 0x0000000400001010ULL, 0x0000000010001010ULL, 0x0000000410001010ULL,
        0x0000000000101010ULL, 0x0000000400101010ULL, 0x0000000010101010ULL, 0x0000000410101010ULL,
        0x1000000000000000ULL, 0x1000000400000000ULL, 0x1000000010000000ULL, 0x1000000410000000ULL,
        0x1000000000100000ULL, 0x1000000400100000ULL, 0x1000000010100000ULL, 0x1000000410100000ULL,
        0x1000000000001000ULL, 0x1000000400001000ULL, 0x1000000010001000ULL, 0x1000000410001000ULL,
        0x1000000000101000ULL, 0x1000000400101000ULL, 0x1000000010101000ULL, 0x1000000410101000ULL,
        0x1000000000000010ULL, 0x1000000400000010ULL, 0x1000000010000010ULL, 0x1000000410000010ULL,
        0x1000000000100010ULL, 0x1000000400100010ULL, 0x1000000010100010ULL, 0x1000000410100010ULL,
        0x1000000000001010ULL, 0x1000000400001010ULL, 0x1000000010001010ULL, 0x1000000410001010ULL,
        0x1000000000101010ULL, 0x1000000400101010ULL, 0x1000000010101010ULL, 0x1000000410101010ULL,
        0x0010000000000000ULL, 0x0010000400000000ULL, 0x0010000010000000ULL, 0x0010000410000000ULL,
        0x0010000000100000ULL, 0x0010000400100000ULL, 0x0010000010100000ULL, 0x0010000410100000ULL,
        0x0010000000001000ULL, 0x0010000400001000ULL, 0x0010000010001000ULL, 0x0010000410001000ULL,
        0x0010000000101000ULL, 0x0010000400101000ULL, 0x0010000010101000ULL, 0x0010000410101000ULL,
        0x0010000000000010ULL, 0x0010000400000010ULL, 0x0010000010000010ULL, 0x0010000410000010ULL,
        0x0010000000100010ULL, 0x0010000400100010ULL, 0x0010000010100010ULL, 0x0010000410100010ULL,
        0x0010000000001010ULL, 0x0010000400001010ULL, 0x0010000010001010ULL, 0x0010000410001010ULL,
        0x0010000000101010ULL, 0x0010000400101010ULL, 0x0010000010101010ULL, 0x0010000410101010ULL,
        0x1010000000000000ULL, 0x1010000400000000ULL, 0x1010000010000000ULL, 0x1010000410000000ULL,
        0x1010000000100000ULL, 0x1010000400100000ULL, 0x1010000010100000ULL, 0x1010000410100000ULL,
        0x1010000000001000ULL, 0x1010000400001000ULL, 0x1010000010001000ULL, 0x1010000410001000ULL,
        0x1010000000101000ULL, 0x1010000400101000ULL, 0x1010000010101000ULL, 0x1010000410101000ULL,
        0x1010000000000010ULL, 0x1010000400000010ULL, 0x1010000010000010ULL, 0x1010000410000010ULL,
        0x1010000000100010ULL, 0x1010000400100010ULL, 0x1010000010100010ULL, 0x1010000410100010ULL,
        0x1010000000001010ULL, 0x1010000400001010ULL, 0x1010000010001010ULL, 0x1010000410001010ULL,
        0x1010000000101010ULL, 0x1010000400101010ULL, 0x1010000010101010ULL, 0x1010000410101010ULL,
        0x0000100000000000ULL, 0x0000100400000000ULL, 0x0000100010000000ULL, 0x0000100410000000ULL,
        0x0000100000100000ULL, 0x0000100400100000ULL, 0x0000100010100000ULL, 0x0000100410100000ULL,
        0x0000100000001000ULL, 0x0000100400001000ULL, 0x0000100010001000ULL, 0x0000100410001000ULL,
        0x0000100000101000ULL, 0x0000100400101000ULL, 0x0000100010101000ULL, 0x0000100410101000ULL,
        0x0000100000000010ULL, 0x0000100400000010ULL, 0x0000100010000010ULL, 0x0000100410000010ULL,
        0x0000100000100010ULL, 0x0000100400100010ULL, 0x0000100010100010ULL, 0x0000100410100010ULL,
        0x0000100000001010ULL, 0x0000100400001010ULL, 0x0000100010001010ULL, 0x0000100410001010ULL,
        0x0000100000101010ULL, 0x0000100400101010ULL, 0x0000100010101010ULL, 0x0000100410101010ULL,
        0x1000100000000000ULL, 0x1000100400000000ULL, 0x1000100010000000ULL, 0x1000100410000000ULL,
        0x1000100000100000ULL, 0x1000100400100000ULL, 0x1000100010100000ULL, 0x1000100410100000ULL,
        0x1000100000001000ULL, 0x1000100400001000ULL, 0x1000100010001000ULL, 0x1000100410001000ULL,
        0x1000100000101000ULL, 0x1000100400101000ULL, 0x1000100010101000ULL, 0x1000100410101000ULL,
        0x1000100000000010ULL, 0x1000100400000010ULL, 0x1000100010000010ULL, 0x1000100410000010ULL,
        0x1000100000100010ULL, 0x1000100400100010ULL, 0x1000100010100010ULL, 0x1000100410100010ULL,
        0x1000100000001010ULL, 0x1000100400001010ULL, 0x1000100010001010ULL, 0x1000100410001010ULL,
        0x1000100000101010ULL, 0x1000100400101010ULL, 0x1000100010101010ULL, 0x1000100410101010ULL,
        0x0010100000000000ULL, 0x0010100400000000ULL, 0x0010100010000000ULL, 0x0010100410000000ULL,
        0x0010100000100000ULL, 0x0010100400100000ULL, 0x0010100010100000ULL, 0x0010100410100000ULL,
        0x0010100000001000ULL, 0x0010100400001000ULL, 0x0010100010001000ULL, 0x0010100410001000ULL,
        0x0010100000101000ULL, 0x0010100400101000ULL, 0x0010100010101000ULL, 0x0010100410101000ULL,
        0x0010100000000010ULL, 0x0010100400000010ULL, 0x0010100010000010ULL, 0x0010100410000010ULL,
        0x0010100000100010ULL, 0x0010100400100010ULL, 0x0010100010100010ULL, 0x0010100410100010ULL,
        0x0010100000001010ULL, 0x0010100400001010ULL, 0x0010100010001010ULL, 0x0010100410001010ULL,
        0x0010100000101010ULL, 0x0010100400101010ULL, 0x0010100010101010ULL, 0x0010100410101010ULL,
        0x1010100000000000ULL, 0x1010100400000000ULL, 0x1010100010000000ULL, 0x1010100410000000ULL,
        0x1010100000100000ULL, 0x1010100400100000ULL, 0x1010100010100000ULL, 0x1010100410100000ULL,
        0x1010100000001000ULL, 0x1010100400001000ULL, 0x1010100010001000ULL, 0x1010100410001000ULL,
        0x1010100000101000ULL, 0x1010100400101000ULL, 0x1010100010101000ULL, 0x1010100410101000ULL,
        0x1010100000000010ULL, 0x1010100400000010ULL, 0x1010100010000010ULL, 0x1010100410000010ULL,
        0x1010100000100010ULL, 0x1010100400100010ULL, 0x1010100010100010ULL, 0x1010100410100010ULL,
        0x1010100000001010ULL, 0x1010100400001010ULL, 0x1010100010001010ULL, 0x1010100410001010ULL,
        0x1010100000101010ULL, 0x1010100400101010ULL, 0x1010100010101010ULL, 0x1010100410101010ULL
    },
    {
        0x0000000000000000ULL, 0x0000001000000000ULL, 0x0000000040000000ULL, 0x0000001040000000ULL,
        0x0000000000400000ULL, 0x0000001000400000ULL, 0x0000000040400000ULL, 0x0000001040400000ULL,
        0x0000000000004000ULL, 0x0000001000004000ULL, 0x0000000040004000ULL, 0x0000001040004000ULL,
        0x0000000000404000ULL, 0x0000001000404000ULL, 0x0000000040404000ULL, 0x0000001040404000ULL,
        0x0000000000000040ULL, 0x0000001000000040ULL, 0x0000000040000040ULL, 0x0000001040000040ULL,
        0x0000000000400040ULL, 0x0000001000400040ULL, 0x0000000040400040ULL, 0x0000001040400040ULL,
        0x0000000000004040ULL, 0x0000001000004040ULL, 0x0000000040004040ULL, 0x0000001040004040ULL,
        0x0000000000404040ULL, 0x0000001000404040ULL, 0x0000000040404040ULL, 0x0000001040404040ULL,
        0x4000000000000000ULL, 0x4000001000000000ULL, 0x4000000040000000ULL, 0x4000001040000000ULL,
        0x4000000000400000ULL, 0x4000001000400000ULL, 0x4000000040400000ULL, 0x4000001040400000ULL,
        0x4000000000004000ULL, 0x4000001000004000ULL, 0x4000000040004000ULL, 0x4000001040004000ULL,
        0x4000000000404000ULL, 0x4000001000404000ULL, 0x4000000040404000ULL, 0x4000001040404000ULL,
        0x4000000000000040ULL, 0x4000001000000040ULL, 0x4000000040000040ULL, 0x4000001040000040ULL,
        0x4000000000400040ULL, 0x4000001000400040ULL, 0x4000000040400040ULL, 0x4000001040400040ULL,
        0x4000000000004040ULL, 0x4000001000004040ULL, 0x4000000040004040ULL, 0x4000001040004040ULL,
        0x4000000000404040ULL, 0x4000001000404040ULL, 0x4000000040404040ULL, 0x4000001040404040ULL,
        0x0040000000000000ULL, 0x0040001000000000ULL, 0x0040000040000000ULL, 0x0040001040000000ULL,
        0x0040000000400000ULL, 0x0040001000400000ULL, 0x0040000040400000ULL, 0x0040001040400000ULL,
        0x0040000000004000ULL, 0x0040001000004000ULL, 0x0040000040004000ULL, 0x0040001040004000ULL,
        0x0040000000404000ULL, 0x0040001000404000ULL, 0x0040000040404000ULL, 0x0040001040404000ULL,
        0x0040000000000040ULL, 0x0040001000000040ULL, 0x0040000040000040ULL, 0x0040001040000040ULL,
        0x0040000000400040ULL, 0x0040001000400040ULL, 0x0040000040400040ULL, 0x0040001040400040ULL,
        0x0040000000004040ULL, 0x0040001000004040ULL, 0x0040000040004040ULL, 0x0040001040004040ULL,
        0x0040000000404040ULL, 0x0040001000404040ULL, 0x0040000040404040ULL, 0x0040001040404040ULL,
        0x4040000000000000ULL, 0x4040001000000000ULL, 0x4040000040000000ULL, 0x4040001040000000ULL,
        0x4040000000400000ULL, 0x4040001000400000ULL, 0x4040000040400000ULL, 0x4040001040400000ULL,
        0x4040000000004000ULL, 0x4040001000004000ULL, 0x4040000040004000ULL, 0x4040001040004000ULL,
        0x4040000000404000ULL, 0x4040001000404000ULL, 0x4040000040404000ULL, 0x4040001040404000ULL,
        0x4040000000000040ULL, 0x4040001000000040ULL, 0x4040000040000040ULL, 0x4040001040000040ULL,
        0x4040000000400040ULL, 0x4040001000400040ULL, 0x4040000040400040ULL, 0x4040001040400040ULL,
        0x4040000000004040ULL, 0x4040001000004040ULL, 0x4040000040004040ULL, 0x4040001040004040ULL,
        0x4040000000404040ULL, 0x4040001000404040ULL, 0x4040000040404040ULL, 0x4040001040404040ULL,
        0x0000400000000000ULL, 0x0000401000000000ULL, 0x0000400040000000ULL, 0x0000401040000000ULL,
        0x0000400000400000ULL, 0x0000401000400000ULL, 0x0000400040400000ULL, 0x0000401040400000ULL,
        0x0000400000004000ULL, 0x0000401000004000ULL, 0x0000400040004000ULL, 0x0000401040004000ULL,
        0x0000400000404000ULL, 0x0000401000404000ULL, 0x0000400040404000ULL, 0x0000401040404000ULL,
        0x0000400000000040ULL, 0x0000401000000040ULL, 0x0000400040000040ULL, 0x0000401040000040ULL,
        0x0000400000400040ULL, 0x0000401000400040ULL, 0x0000400040400040ULL, 0x0000401040400040ULL,
        0x0000400000004040ULL, 0x0000401000004040ULL, 0x0000400040004040ULL, 0x0000401040004040ULL,
        0x0000400000404040ULL, 0x0000401000404040ULL, 0x0000400040404040ULL, 0x0000401040404040ULL,
        0x4000400000000000ULL, 0x4000401000000000ULL, 0x4000400040000000ULL, 0x4000401040000000ULL,
        0x4000400000400000ULL, 0x4000401000400000ULL, 0x4000400040400000ULL, 0x4000401040400000ULL,
        0x4000400000004000ULL, 0x4000401000004000ULL, 0x4000400040004000ULL, 0x4000401040004000ULL,
        0x4000400000404000ULL, 0x4000401000404000ULL, 0x4000400040404000ULL, 0x4000401040404000ULL,
        0x4000400000000040ULL, 0x4000401000000040ULL, 0x4000400040000040ULL, 0x4000401040000040ULL,
        0x4000400000400040ULL, 0x4000401000400040ULL, 0x4000400040400040ULL, 0x4000401040400040ULL,
        0x4000400000004040ULL, 0x4000401000004040ULL, 0x4000400040004040ULL, 0x4000401040004040ULL,
        0x4000400000404040ULL, 0x4000401000404040ULL, 0x4000400040404040ULL, 0x4000401040404040ULL,
        0x0040400000000000ULL, 0x0040401000000000ULL, 0x0040400040000000ULL, 0x0040401040000000ULL,
        0x0040400000400000ULL, 0x0040401000400000ULL, 0x0040400040400000ULL, 0x0040401040400000ULL,
        0x0040400000004000ULL, 0x0040401000004000ULL, 0x0040400040004000ULL, 0x0040401040004000ULL,
        0x0040400000404000ULL, 0x0040401000404000ULL, 0x0040400040404000ULL, 0x0040401040404000ULL,
        0x0040400000000040ULL, 0x0040401000000040ULL, 0x0040400040000040ULL, 0x0040401040000040ULL,
        0x0040400000400040ULL, 0x0040401000400040ULL, 0x0040400040400040ULL, 0x0040401040400040ULL,
        0x0040400000004040ULL, 0x0040401000004040ULL, 0x0040400040004040ULL, 0x0040401040004040ULL,
        0x0040400000404040ULL, 0x0040401000404040ULL, 0x0040400040404040ULL, 0x0040401040404040ULL,
        0x4040400000000000ULL, 0x4040401000000000ULL, 0x4040400040000000ULL, 0x4040401040000000ULL,
        0x4040400000400000ULL, 0x4040401000400000ULL, 0x4040400040400000ULL, 0x4040401040400000ULL,
        0x4040400000004000ULL, 0x4040401000004000ULL, 0x4040400040004000ULL, 0x4040401040004000ULL,
        0x4040400000404000ULL, 0x4040401000404000ULL, 0x4040400040404000ULL, 0x4040401040404000ULL,
        0x4040400000000040ULL, 0x4040401000000040ULL, 0x4040400040000040ULL, 0x4040401040000040ULL,
        0x4040400000400040ULL, 0x4040401000400040ULL, 0x4040400040400040ULL, 0x4040401040400040ULL,
        0x4040400000004040ULL, 0x4040401000004040ULL, 0x4040400040004040ULL, 0x4040401040004040ULL,
        0x4040400000404040ULL, 0x4040401000404040ULL, 0x4040400040404040ULL, 0x4040401040404040ULL
    }
};

#define RORc(x, y) ( ((((uint32_t)(x)&0xFFFFFFFFUL)>>(uint32_t)((y)&31)) | ((uint32_t)(x)<<(uint32_t)(32-((y)&31)))) & 0xFFFFFFFFUL)
#define SWAP_BYTE_U32(in, out) out = ((in) >> (uint32_t)24 & 255) ^ (((in) >> (uint32_t)16 & 255) << 8) ^ (((in) >> (uint32_t)8 & 255) << 16) ^ (((in) >> (uint32_t)0 & 255) << 24);

static void des_xor(void *arg1, void *arg2, void *out)
{
    uint64_t *a1 = (uint64_t *) arg1;
    uint64_t *a2 = (uint64_t *) arg2;
    uint64_t *o = (uint64_t *) out;

    o[0] = a1[0] ^ a2[0];
}

static int des_init_base(DesCtx *ctx, const ByteArray *key)
{
    const uint8_t *ba_buf;
    size_t key_len;
    int ret = RET_OK;

    CHECK_PARAM(ctx != NULL);
    CHECK_PARAM(key != NULL);
    key_len = ba_get_len(key);
    CHECK_PARAM(key_len == 8 || key_len == 16 || key_len == 24);

    ba_buf = ba_get_buf(key);
    switch (key_len) {
    case 8:
        memcpy(ctx->key, ba_buf, key_len);
        memcpy(&ctx->key[8], ba_buf, key_len);
        memcpy(&ctx->key[16], ba_buf, key_len);
        break;
    case 16:
        memcpy(ctx->key, ba_buf, key_len);
        memcpy(&ctx->key[16], ba_buf, 8);
        break;
    case 24:
    default:
        memcpy(ctx->key, ba_buf, key_len);
    }

cleanup:

    return ret;
}

static void cookey(const uint32_t *raw1, uint32_t *keyout)
{
    uint32_t *cook;
    const uint32_t *raw0;
    uint32_t dough[32];
    int i;

    cook = dough;
    for (i = 0; i < 16; i++, raw1++) {
        raw0 = raw1++;
        *cook = (*raw0 & 0x00fc0000L) << 6;
        *cook |= (*raw0 & 0x00000fc0L) << 10;
        *cook |= (*raw1 & 0x00fc0000L) >> 10;
        *cook++ |= (*raw1 & 0x00000fc0L) >> 6;
        *cook = (*raw0 & 0x0003f000L) << 12;
        *cook |= (*raw0 & 0x0000003fL) << 16;
        *cook |= (*raw1 & 0x0003f000L) >> 4;
        *cook++ |= (*raw1 & 0x0000003fL);
    }

    memcpy(keyout, dough, sizeof (dough));
}

static void deskey(const unsigned char *key, short edf, uint32_t *keyout)
{
    uint32_t i, j, l, m, n, kn[32];
    unsigned char pc1m[56], pcr[56];

    for (j = 0; j < 56; j++) {
        l = (uint32_t) pc1[j];
        m = l & 7;
        pc1m[j] = (unsigned char) ((key[l >> 3U] & bytebit[m]) == bytebit[m] ? 1 : 0);
    }

    for (i = 0; i < 16; i++) {
        if (edf == DE1) {
            m = (15 - i) << 1;
        } else {
            m = i << 1;
        }
        n = m + 1;
        kn[m] = kn[n] = 0L;
        for (j = 0; j < 28; j++) {
            l = totrot[i] + j;
            if (l < 28) {
                pcr[j] = pc1m[l];
            } else {
                pcr[j] = pc1m[l - 28];
            }
        }
        for (/*j = 28*/; j < 56; j++) {
            l = totrot[i] + j;
            if (l < 56) {
                pcr[j] = pc1m[l];
            } else {
                pcr[j] = pc1m[l - 28];
            }
        }
        for (j = 0; j < 24; j++) {
            if ((int) pcr[(int) pc2[j]] != 0) {
                kn[m] |= bigbyte[j];
            }
            if ((int) pcr[(int) pc2[j + 24]] != 0) {
                kn[n] |= bigbyte[j];
            }
        }
    }

    cookey(kn, keyout);
}

static void desfunc(uint32_t *block, const uint32_t *keys)
{
    uint32_t work, right, leftt;
    int cur_round;
    uint64_t tmp;

    SWAP_BYTE_U32(block[0], leftt);
    SWAP_BYTE_U32(block[1], right);

    tmp = des_ip[0][byte(leftt, 0)] ^
            des_ip[1][byte(leftt, 1)] ^
            des_ip[2][byte(leftt, 2)] ^
            des_ip[3][byte(leftt, 3)] ^
            des_ip[4][byte(right, 0)] ^
            des_ip[5][byte(right, 1)] ^
            des_ip[6][byte(right, 2)] ^
            des_ip[7][byte(right, 3)];
    leftt = (uint32_t) (tmp >> 32);
    right = (uint32_t) (tmp & 0xFFFFFFFFUL);


    for (cur_round = 0; cur_round < 8; cur_round++) {
        work = RORc(right, 4) ^ *keys++;
        leftt ^= SP7[work & 0x3fL]
                ^ SP5[(work >> 8) & 0x3fL]
                ^ SP3[(work >> 16) & 0x3fL]
                ^ SP1[(work >> 24) & 0x3fL];
        work = right ^ *keys++;
        leftt ^= SP8[ work & 0x3fL]
                ^ SP6[(work >> 8) & 0x3fL]
                ^ SP4[(work >> 16) & 0x3fL]
                ^ SP2[(work >> 24) & 0x3fL];

        work = RORc(leftt, 4) ^ *keys++;
        right ^= SP7[ work & 0x3fL]
                ^ SP5[(work >> 8) & 0x3fL]
                ^ SP3[(work >> 16) & 0x3fL]
                ^ SP1[(work >> 24) & 0x3fL];
        work = leftt ^ *keys++;
        right ^= SP8[ work & 0x3fL]
                ^ SP6[(work >> 8) & 0x3fL]
                ^ SP4[(work >> 16) & 0x3fL]
                ^ SP2[(work >> 24) & 0x3fL];
    }


    tmp = des_fp[0][byte(leftt, 0)] ^
            des_fp[1][byte(leftt, 1)] ^
            des_fp[2][byte(leftt, 2)] ^
            des_fp[3][byte(leftt, 3)] ^
            des_fp[4][byte(right, 0)] ^
            des_fp[5][byte(right, 1)] ^
            des_fp[6][byte(right, 2)] ^
            des_fp[7][byte(right, 3)];
    leftt = (uint32_t) (tmp >> 32);
    right = (uint32_t) (tmp & 0xFFFFFFFFUL);


    SWAP_BYTE_U32(right, block[0]);
    SWAP_BYTE_U32(leftt, block[1]);
}

static void des_setup(DesCtx *ctx, const uint8_t *key)
{
    deskey(key, EN0, &ctx->enc_key[0]);
    deskey(key, DE1, &ctx->dec_key[64]);

    deskey(key + 8, EN0, &ctx->dec_key[32]);
    deskey(key + 8, DE1, &ctx->enc_key[32]);

    deskey(key + 16, EN0, &ctx->enc_key[64]);
    deskey(key + 16, DE1, &ctx->dec_key[0]);
}

static void des_crypt(uint8_t *block, uint8_t *out, const uint32_t *key)
{
    uint32_t block32[2];

    uint8_to_uint32(block, 8, block32, 2);
    desfunc(block32, key);
    uint32_to_uint8(block32, 2, out, 8);
}

static void des3_crypt(uint8_t *block, uint8_t *out, const uint32_t *keys)
{
    uint32_t block32[2];

    uint8_to_uint32(block, 8, block32, 2);

    desfunc(block32, &keys[0]);
    desfunc(block32, &keys[32]);
    desfunc(block32, &keys[64]);

    uint32_to_uint8(block32, 2, out, 8);
}

static int des_encrypt_ofb(DesCtx *ctx, uint32_t *key_shedule, const ByteArray *in, ByteArray **dst)
{
    uint8_t *gamma = ctx->gamma_des;
    ByteArray *out = NULL;
    int ret = RET_OK;
    size_t data_off = 0;
    uint8_t *in_buf = in->buf;
    size_t in_len = in->len;

    CHECK_NOT_NULL(out = ba_alloc_by_len(in_len));

    /* Использование оставшейся гаммы. */
    if (ctx->offset != 0) {
        while (ctx->offset < DES_BLOCK_LEN && data_off < in_len) {
            out->buf[data_off] = in_buf[data_off] ^ gamma[ctx->offset];
            ctx->offset++;
            data_off++;
        }

        if (ctx->offset == DES_BLOCK_LEN) {
            des_crypt(gamma, gamma, key_shedule);
            ctx->offset = 0;
        }
    }

    if (data_off < in_len) {
        /* Шифрование блоками по DES_BLOCK_LEN байт. */
        for (; data_off + DES_BLOCK_LEN <= in_len; data_off += DES_BLOCK_LEN) {
            des_xor(&in_buf[data_off], gamma, &out->buf[data_off]);
            des_crypt(gamma, gamma, key_shedule);
        }
        /* Шифрование последнего неполного блока. */
        for (; data_off < in_len; data_off++) {
            out->buf[data_off] = in_buf[data_off] ^ gamma[ctx->offset];
            ctx->offset++;
        }
    }

    *dst = out;

cleanup:

    return ret;
}

static int des3_encrypt_ofb(DesCtx *ctx, uint32_t *key_shedule, const ByteArray *in, ByteArray **dst)
{
    uint8_t *gamma = ctx->gamma_des3;
    ByteArray *out = NULL;
    int ret = RET_OK;
    size_t data_off = 0;
    uint8_t *in_buf = in->buf;
    size_t in_len = in->len;

    CHECK_NOT_NULL(out = ba_alloc_by_len(in_len));

    /* Использование оставшейся гаммы. */
    if (ctx->offset != 0) {
        while (ctx->offset < DES_BLOCK_LEN && data_off < in_len) {
            out->buf[data_off] = in_buf[data_off] ^ gamma[ctx->offset];
            ctx->offset++;
            data_off++;
        }

        if (ctx->offset == DES_BLOCK_LEN) {
            des3_crypt(gamma, gamma, key_shedule);
            ctx->offset = 0;
        }
    }

    if (data_off < in_len) {
        /* Шифрование блоками по DES_BLOCK_LEN байт. */
        for (; data_off + DES_BLOCK_LEN <= in_len; data_off += DES_BLOCK_LEN) {
            des_xor(&in_buf[data_off], gamma, &out->buf[data_off]);
            des3_crypt(gamma, gamma, key_shedule);
        }

        /* Шифрование последнего неполного блока. */
        for (; data_off < in_len; data_off++) {
            out->buf[data_off] = in_buf[data_off] ^ gamma[ctx->offset];
            ctx->offset++;
        }
    }

    *dst = out;

cleanup:

    return ret;
}

static int des_encrypt_ecb(uint32_t *key_shedule, const ByteArray *in, ByteArray **out)
{
    size_t i;
    int ret = RET_OK;
    ByteArray *cip = NULL;

    if (in->len % DES_BLOCK_LEN != 0) {
        SET_ERROR(RET_INVALID_DATA_LEN);
    }

    CHECK_NOT_NULL(cip = ba_alloc_by_len(in->len));

    for (i = 0; i < in->len; i += DES_BLOCK_LEN) {
        des_crypt(&in->buf[i], &cip->buf[i], key_shedule);
    }

    *out = cip;

cleanup:

    return ret;
}

static __inline int des3_encrypt_ecb(uint32_t *key_shedule, const ByteArray *in, ByteArray **out)
{
    size_t i;
    int ret = RET_OK;
    ByteArray *cip = NULL;

    if (in->len % DES_BLOCK_LEN != 0) {
        SET_ERROR(RET_INVALID_DATA_LEN);
    }

    CHECK_NOT_NULL(cip = ba_alloc_by_len(in->len));

    for (i = 0; i < in->len; i += DES_BLOCK_LEN) {
        des3_crypt(&in->buf[i], &cip->buf[i], key_shedule);
    }

    *out = cip;

cleanup:

    return ret;
}

static int des_encrypt_cbc(DesCtx *ctx, const ByteArray *in, ByteArray **dst)
{
    ByteArray *out = NULL;
    int ret = RET_OK;
    int data_off = 0;

    if (in->len % DES_BLOCK_LEN != 0) {
        SET_ERROR(RET_INVALID_DATA_LEN);
    }

    CHECK_NOT_NULL(out = ba_alloc_by_len(in->len));

    for (; data_off + DES_BLOCK_LEN <= (int)in->len; data_off += DES_BLOCK_LEN) {
        des_xor(&in->buf[data_off], ctx->gamma_des3, ctx->gamma_des3);
        des_crypt(ctx->gamma_des3, &out->buf[data_off], ctx->enc_key);
        memcpy(ctx->gamma_des3, &out->buf[data_off], DES_BLOCK_LEN);
    }

    *dst = out;
    out = NULL;

cleanup:

    ba_free(out);

    return ret;
}

static int des3_encrypt_cbc(DesCtx *ctx, const ByteArray *in, ByteArray **dst)
{
    ByteArray *out = NULL;
    int ret = RET_OK;
    int data_off = 0;

    if (in->len % DES_BLOCK_LEN != 0) {
        SET_ERROR(RET_INVALID_DATA_LEN);
    }

    CHECK_NOT_NULL(out = ba_alloc_by_len(in->len));

    for (; data_off + DES_BLOCK_LEN <= (int)in->len; data_off += DES_BLOCK_LEN) {
        des_xor(&in->buf[data_off], ctx->gamma_des3, ctx->gamma_des3);
        des3_crypt(ctx->gamma_des3, &out->buf[data_off], ctx->enc_key);
        memcpy(ctx->gamma_des3, &out->buf[data_off], DES_BLOCK_LEN);
    }

    *dst = out;
    out = NULL;

cleanup:

    ba_free(out);

    return ret;
}

static int des_encrypt_cfb(DesCtx *ctx, const ByteArray *in, ByteArray **dst)
{
    uint8_t *gamma = ctx->gamma_des;
    uint8_t *feed = ctx->feed;
    uint8_t *in_buf = in->buf;
    ByteArray *out = NULL;
    int ret = RET_OK;
    size_t data_off = 0;
    size_t in_len = in->len;

    CHECK_NOT_NULL(out = ba_alloc_by_len(in_len));

    /* Использование оставшейся гаммы. */
    if (ctx->offset != 0) {
        while (ctx->offset < DES_BLOCK_LEN && data_off < in_len) {
            out->buf[data_off] = in_buf[data_off] ^ gamma[ctx->offset];
            feed[ctx->offset++] = out->buf[data_off++];
        }

        if (ctx->offset == DES_BLOCK_LEN) {
            des_crypt(feed, gamma, ctx->enc_key);
            ctx->offset = 0;
        }
    }

    if (data_off < in_len) {
        /* Шифрование блоками по DES_BLOCK_LEN байт. */
        for (; data_off + DES_BLOCK_LEN <= in_len; data_off += DES_BLOCK_LEN) {
            des_xor(&in_buf[data_off], gamma, &out->buf[data_off]);
            memcpy(feed, &out->buf[data_off], DES_BLOCK_LEN);

            des_crypt(feed, gamma, ctx->enc_key);
        }

        /* Шифрование последнего неполного блока. */
        for (; data_off < in_len; data_off++) {
            out->buf[data_off] = in_buf[data_off] ^ gamma[ctx->offset];
            feed[ctx->offset++] = out->buf[data_off];
        }
    }

    *dst = out;

cleanup:

    return ret;
}

static int des3_encrypt_cfb(DesCtx *ctx, const ByteArray *in, ByteArray **dst)
{
    uint8_t *gamma = ctx->gamma_des;
    uint8_t *feed = ctx->feed;
    ByteArray *out = NULL;
    int ret = RET_OK;
    size_t data_off = 0;
    uint8_t *in_buf = in->buf;
    size_t in_len = in->len;

    CHECK_NOT_NULL(out = ba_alloc_by_len(in_len));

    /* Использование оставшейся гаммы. */
    if (ctx->offset != 0) {
        while (ctx->offset < DES_BLOCK_LEN && data_off < in_len) {
            out->buf[data_off] = in_buf[data_off] ^ gamma[ctx->offset];
            feed[ctx->offset++] = out->buf[data_off++];
        }

        if (ctx->offset == DES_BLOCK_LEN) {
            des3_crypt(feed, gamma, ctx->enc_key);
            ctx->offset = 0;
        }
    }

    if (data_off < in_len) {
        /* Шифрование блоками по DES_BLOCK_LEN байт. */
        for (; data_off + DES_BLOCK_LEN <= in_len; data_off += DES_BLOCK_LEN) {
            des_xor(&in_buf[data_off], gamma, &out->buf[data_off]);
            memcpy(feed, &out->buf[data_off], DES_BLOCK_LEN);

            des3_crypt(feed, gamma, ctx->enc_key);
        }
        /* Шифрование последнего неполного блока. */
        for (; data_off < in_len; data_off++) {
            out->buf[data_off] = in_buf[data_off] ^ gamma[ctx->offset];
            feed[ctx->offset++] = out->buf[data_off];
        }
    }

    *dst = out;

cleanup:

    return ret;
}

static int des_decrypt_cfb(DesCtx *ctx, const ByteArray *in, ByteArray **dst)
{
    int ret = RET_OK;
    uint8_t *gamma = ctx->gamma_des;
    uint8_t *feed = ctx->feed;
    size_t data_off = 0;
    ByteArray *out = NULL;
    uint8_t *in_buf = in->buf;
    size_t in_len = in->len;

    CHECK_NOT_NULL(out = ba_alloc_by_len(in_len));

    /* Использование оставшейся гаммы. */
    if (ctx->offset != 0) {
        while (ctx->offset < DES_BLOCK_LEN && data_off < in_len) {
            feed[ctx->offset] = in_buf[data_off];
            out->buf[data_off] = in_buf[data_off] ^ gamma[ctx->offset++];
            data_off++;
        }

        if (ctx->offset == DES_BLOCK_LEN) {
            des_crypt(feed, gamma, ctx->enc_key);
            ctx->offset = 0;
        }
    }

    if (data_off < in_len) {
        /* Расшифрование блоками по DES_BLOCK_LEN байт. */
        for (; data_off + DES_BLOCK_LEN <= in_len; data_off += DES_BLOCK_LEN) {
            memcpy(feed, &in_buf[data_off], DES_BLOCK_LEN);
            des_xor(&in_buf[data_off], gamma, &out->buf[data_off]);

            des_crypt(feed, gamma, ctx->enc_key);
        }


        /* Расшифрование последнего неполного блока. */
        for (; data_off < in_len; data_off++) {
            feed[ctx->offset] = in_buf[data_off];
            out->buf[data_off] = in_buf[data_off] ^ gamma[ctx->offset++];
        }
    }

    *dst = out;

cleanup:

    return ret;
}

static int des3_decrypt_cfb(DesCtx *ctx, const ByteArray *in, ByteArray **dst)
{
    int ret = RET_OK;
    uint8_t *gamma = ctx->gamma_des;
    uint8_t *feed = ctx->feed;
    size_t data_off = 0;
    ByteArray *out = NULL;
    uint8_t *in_buf = in->buf;
    size_t in_len = in->len;

    CHECK_NOT_NULL(out = ba_alloc_by_len(in_len));

    /* Использование оставшейся гаммы. */
    if (ctx->offset != 0) {
        while (ctx->offset < DES_BLOCK_LEN && data_off < in_len) {
            feed[ctx->offset] = in_buf[data_off];
            out->buf[data_off] = in_buf[data_off] ^ gamma[ctx->offset++];
            data_off++;
        }

        if (ctx->offset == DES_BLOCK_LEN) {
            des3_crypt(feed, gamma, ctx->enc_key);
            ctx->offset = 0;
        }
    }

    if (data_off < in_len) {
        /* Расшифрование блоками по DES_BLOCK_LEN байт. */
        for (; data_off + DES_BLOCK_LEN <= in_len; data_off += DES_BLOCK_LEN) {
            memcpy(feed, &in_buf[data_off], DES_BLOCK_LEN);
            des_xor(&in_buf[data_off], gamma, &out->buf[data_off]);

            des3_crypt(feed, gamma, ctx->enc_key);
        }

        /* Расшифрование последнего неполного блока. */
        for (; data_off < in_len; data_off++) {
            feed[ctx->offset] = in_buf[data_off];
            out->buf[data_off] = in_buf[data_off] ^ gamma[ctx->offset++];
        }
    }

    *dst = out;

cleanup:

    return ret;
}

static int des_decrypt_cbc(DesCtx *ctx, const ByteArray *in, ByteArray **out)
{
    size_t i = 0;
    uint8_t prev[8];
    int ret = RET_OK;
    ByteArray *pt = NULL;

    CHECK_NOT_NULL(pt = ba_copy_with_alloc(in, 0, 0));
    uint8_t *in_buf = pt->buf;
    size_t in_len = pt->len;

    memcpy(ctx->gamma_des3, in_buf, DES_BLOCK_LEN);
    des_crypt(&in_buf[i], &in_buf[i], &ctx->dec_key[64]);
    des_xor(&in_buf[i], ctx->iv, &in_buf[i]);

    for (i = DES_BLOCK_LEN; i < in_len; i += DES_BLOCK_LEN) {
        memcpy(prev, &in_buf[i], DES_BLOCK_LEN);
        des_crypt(&in_buf[i], &in_buf[i], &ctx->dec_key[64]);
        des_xor(&in_buf[i], ctx->gamma_des3, &in_buf[i]);
        memcpy(ctx->gamma_des3, prev, DES_BLOCK_LEN);
    }

    *out = pt;

cleanup:

    return ret;
}

static int des3_decrypt_cbc(DesCtx *ctx, const ByteArray *in, ByteArray **out)
{
    size_t i = 0;
    uint8_t prev[8];
    int ret = RET_OK;
    ByteArray *pt = NULL;

    CHECK_NOT_NULL(pt = ba_copy_with_alloc(in, 0, 0));
    uint8_t *in_buf = pt->buf;
    size_t in_len = pt->len;

    memcpy(ctx->gamma_des3, in_buf, DES_BLOCK_LEN);
    des3_crypt(&in_buf[i], &in_buf[i], ctx->dec_key);
    des_xor(&in_buf[i], ctx->iv, &in_buf[i]);

    for (i = 8; i < in_len; i += DES_BLOCK_LEN) {
        memcpy(prev, &in_buf[i], DES_BLOCK_LEN);
        des3_crypt(&in_buf[i], &in_buf[i], ctx->dec_key);
        des_xor(&in_buf[i], ctx->gamma_des3, &in_buf[i]);
        memcpy(ctx->gamma_des3, prev, DES_BLOCK_LEN);
    }

    *out = pt;

cleanup:

    return ret;
}

static void gamma_gen(uint8_t *gamma, size_t size)
{
    size--;
    do {
        gamma[size]++;
    } while (gamma[size--] == 0);
}

static int des_encrypt_ctr(DesCtx *ctx, uint32_t *key_shedule, const ByteArray *in, ByteArray **dst)
{
    uint8_t *gamma = ctx->gamma_des3;
    uint8_t *feed = ctx->feed;
    ByteArray *out = NULL;
    int ret = RET_OK;
    size_t data_off = 0;
    uint8_t *in_buf = in->buf;
    size_t in_len = in->len;

    CHECK_NOT_NULL(out = ba_alloc_by_len(in_len));

    /* Использование оставшейся гаммы. */
    if (ctx->offset != 0) {
        while (ctx->offset < DES_BLOCK_LEN && data_off < in_len) {
            out->buf[data_off] = in_buf[data_off] ^ gamma[ctx->offset];
            data_off++;
            ctx->offset++;
        }

        if (ctx->offset == DES_BLOCK_LEN) {
            des3_crypt(feed, gamma, key_shedule);
            gamma_gen(feed, DES_BLOCK_LEN);
            ctx->offset = 0;
        }
    }

    if (data_off < in_len) {
        /* Шифрование блоками по 8 байт. */
        for (; data_off + DES_BLOCK_LEN <= in_len; data_off += DES_BLOCK_LEN) {
            des_xor(&in_buf[data_off], gamma, &out->buf[data_off]);

            des3_crypt(feed, gamma, key_shedule);
            gamma_gen(feed, DES_BLOCK_LEN);
        }
        /* Шифрование последнего неполного блока. */
        for (; data_off < in_len; data_off++) {
            out->buf[data_off] = in_buf[data_off] ^ gamma[ctx->offset++];
        }
    }

    *dst = out;

cleanup:

    return ret;
}

static int des3_encrypt_ctr(DesCtx *ctx, uint32_t *key_shedule, const ByteArray *in, ByteArray **dst)
{
    uint8_t *gamma = ctx->gamma_des3;
    uint8_t *feed = ctx->feed;
    ByteArray *out = NULL;
    int ret = RET_OK;
    size_t data_off = 0;
    uint8_t *in_buf = in->buf;
    size_t in_len = in->len;

    CHECK_NOT_NULL(out = ba_alloc_by_len(in_len));

    /* Использование оставшейся гаммы. */
    if (ctx->offset != 0) {
        while (ctx->offset < DES_BLOCK_LEN && data_off < in_len) {
            out->buf[data_off] = in_buf[data_off] ^ gamma[ctx->offset];
            data_off++;
            ctx->offset++;
        }

        if (ctx->offset == DES_BLOCK_LEN) {
            des3_crypt(feed, gamma, key_shedule);
            gamma_gen(feed, DES_BLOCK_LEN);
            ctx->offset = 0;
        }
    }

    if (data_off < in_len) {
        /* Шифрование блоками по 8 байт. */
        for (; data_off + DES_BLOCK_LEN <= in_len; data_off += DES_BLOCK_LEN) {
            des_xor(&in_buf[data_off], gamma, &out->buf[data_off]);

            des3_crypt(feed, gamma, key_shedule);
            gamma_gen(feed, DES_BLOCK_LEN);
        }

        /* Шифрование последнего неполного блока. */
        for (; data_off < in_len; data_off++) {
            out->buf[data_off] = in_buf[data_off] ^ gamma[ctx->offset++];
        }
    }

    *dst = out;

cleanup:

    return ret;
}

int des_init_ecb(DesCtx *ctx, const ByteArray *key)
{
    int ret = RET_OK;

    DO(des_init_base(ctx, key));
    des_setup(ctx, ctx->key);
    ctx->mode = ECB;

cleanup:

    return ret;
}

int des_init_cbc(DesCtx *ctx, const ByteArray *key, const ByteArray *iv)
{
    int ret = RET_OK;

    CHECK_PARAM(ctx != NULL);
    CHECK_PARAM(key != NULL);
    CHECK_PARAM(iv != NULL);
    CHECK_PARAM(iv->len == DES_BLOCK_LEN);
    CHECK_PARAM(key->len == DES_BLOCK_LEN || key->len == (DES_BLOCK_LEN << 1) || key->len == (DES_BLOCK_LEN * 3));

    DO(des_init_base(ctx, key));
    DO(ba_to_uint8(iv, ctx->iv, ba_get_len(iv)));
    des_setup(ctx, ctx->key);
    ctx->mode = CBC;
    memcpy(ctx->gamma_des, ctx->iv, ba_get_len(iv));
    memcpy(ctx->gamma_des3, ctx->iv, ba_get_len(iv));

cleanup:

    return ret;
}

int des_init_ofb(DesCtx *ctx, const ByteArray *key, const ByteArray *iv)
{
    int ret = RET_OK;

    CHECK_PARAM(ctx != NULL);
    CHECK_PARAM(key != NULL);
    CHECK_PARAM(iv != NULL);

    DO(des_init_base(ctx, key));
    DO(ba_to_uint8(iv, ctx->iv, ba_get_len(iv)));
    des_setup(ctx, ctx->key);
    ctx->mode = OFB;
    memcpy(ctx->gamma_des, ctx->iv, DES_BLOCK_LEN);
    memcpy(ctx->gamma_des3, ctx->iv, DES_BLOCK_LEN);

    DO(ba_to_uint8(iv, ctx->feed, DES_BLOCK_LEN));
    ctx->offset = DES_BLOCK_LEN;

cleanup:

    return ret;
}

int des_init_ctr(DesCtx *ctx, const ByteArray *key, const ByteArray *iv)
{
    int ret = RET_OK;

    CHECK_PARAM(ctx != NULL);
    CHECK_PARAM(key != NULL);
    CHECK_PARAM(iv != NULL);

    DO(des_init_base(ctx, key));
    DO(ba_to_uint8(iv, ctx->iv, ba_get_len(iv)));
    des_setup(ctx, ctx->key);

    ctx->mode = CTR;
    memcpy(ctx->gamma_des, ctx->iv, DES_BLOCK_LEN);
    memcpy(ctx->gamma_des3, ctx->iv, DES_BLOCK_LEN);

    DO(ba_to_uint8(iv, ctx->feed, DES_BLOCK_LEN));
    ctx->offset = DES_BLOCK_LEN;

cleanup:

    return ret;
}

int des_init_cfb(DesCtx *ctx, const ByteArray *key, const ByteArray *iv)
{
    int ret = RET_OK;
    size_t iv_len;

    CHECK_PARAM(ctx != NULL);
    CHECK_PARAM(key != NULL);
    CHECK_PARAM(iv != NULL);

    iv_len = ba_get_len(iv);
    DO(des_init_base(ctx, key));
    DO(ba_to_uint8(iv, ctx->iv, iv_len));
    des_setup(ctx, ctx->key);

    ctx->mode = CFB;
    memcpy(ctx->gamma_des, ctx->iv, iv_len);
    memcpy(ctx->gamma_des3, ctx->iv, iv_len);

    DO(ba_to_uint8(iv, ctx->feed, DES_BLOCK_LEN));
    ctx->offset = DES_BLOCK_LEN;

cleanup:

    return ret;
}

int des3_encrypt(DesCtx *ctx, const ByteArray *in, ByteArray **out)
{
    int ret = RET_OK;

    CHECK_PARAM(ctx);
    CHECK_PARAM(in);
    CHECK_PARAM(out);

    switch (ctx->mode) {
    case ECB:
        DO(des3_encrypt_ecb(ctx->enc_key, in, out));
        break;
    case CTR:
        DO(des3_encrypt_ctr(ctx, ctx->enc_key, in, out));
        break;
    case CFB:
        DO(des3_encrypt_cfb(ctx, in, out));
        break;
    case CBC:
        DO(des3_encrypt_cbc(ctx, in, out));
        break;
    case OFB:
        DO(des3_encrypt_ofb(ctx, ctx->enc_key, in, out));
        break;
    default:
        SET_ERROR(RET_INVALID_CTX_MODE);
    }

cleanup:

    return ret;
}

int des_encrypt(DesCtx *ctx, const ByteArray *in, ByteArray **out)
{
    int ret = RET_OK;

    CHECK_PARAM(ctx);
    CHECK_PARAM(in);
    CHECK_PARAM(out);

    switch (ctx->mode) {
    case ECB:
        DO(des_encrypt_ecb(ctx->enc_key, in, out));
        break;
    case CTR:
        DO(des_encrypt_ctr(ctx, ctx->enc_key, in, out));
        break;
    case CFB:
        DO(des_encrypt_cfb(ctx, in, out));
        break;
    case CBC:
        DO(des_encrypt_cbc(ctx, in, out));
        break;
    case OFB:
        DO(des_encrypt_ofb(ctx, ctx->enc_key, in, out));
        break;
    default:
        SET_ERROR(RET_INVALID_CTX_MODE);
    }

cleanup:

    return ret;
}

int des_decrypt(DesCtx *ctx, const ByteArray *in, ByteArray **out)
{
    int ret = RET_OK;

    CHECK_PARAM(ctx);
    CHECK_PARAM(in);
    CHECK_PARAM(out);

    switch (ctx->mode) {
    case ECB:
        DO(des_encrypt_ecb(&ctx->dec_key[64], in, out));
        break;
    case CTR:
        DO(des_encrypt_ctr(ctx, ctx->enc_key, in, out));
        break;
    case CFB:
        DO(des_decrypt_cfb(ctx, in, out));
        break;
    case CBC:
        DO(des_decrypt_cbc(ctx, in, out));
        break;
    case OFB:
        DO(des_encrypt_ofb(ctx, ctx->enc_key, in, out));
        break;
    default:
        SET_ERROR(RET_INVALID_CTX_MODE);
        break;
    }

cleanup:

    return ret;
}

int des3_decrypt(DesCtx *ctx, const ByteArray *in, ByteArray **out)
{
    int ret = RET_OK;

    CHECK_PARAM(ctx);
    CHECK_PARAM(in);
    CHECK_PARAM(out);

    switch (ctx->mode) {
    case ECB:
        DO(des3_encrypt_ecb(ctx->dec_key, in, out));
        break;
    case CTR:
        DO(des3_encrypt_ctr(ctx, ctx->enc_key, in, out));
        break;
    case CFB:
        DO(des3_decrypt_cfb(ctx, in, out));
        break;
    case CBC:
        DO(des3_decrypt_cbc(ctx, in, out));
        break;
    case OFB:
        DO(des3_encrypt_ofb(ctx, ctx->enc_key, in, out));
        break;
    default:
        SET_ERROR(RET_INVALID_CTX_MODE);
        break;
    }

cleanup:

    return ret;
}

DesCtx *des_alloc(void)
{
    DesCtx *ctx = NULL;
    int ret = RET_OK;

    CALLOC_CHECKED(ctx, sizeof(DesCtx));

cleanup:

    return ctx;
}

int des_generate_key(PrngCtx *prng, size_t key_len, ByteArray **key)
{
    int ret = RET_OK;

    CHECK_PARAM(key_len == 8 || key_len == 16 || key_len == 24)

    CHECK_NOT_NULL(*key = ba_alloc_by_len(key_len));
    DO(prng_next_bytes(prng, *key));

cleanup:

    return ret;
}

void des_free(DesCtx *ctx)
{
    if (ctx) {
        memset(ctx, 0, sizeof(DesCtx));
        free(ctx);
    }
}
